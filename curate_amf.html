<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>3c. AMF Data Curation – SWELTR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./curate_oo.html" rel="next">
<link href="./curate_its.html" rel="prev">
<link href="./assets/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-59898bd1c6b9d2bb783127feaa000c76.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-d329e753491efaeac79c98c4b193a686.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-59898bd1c6b9d2bb783127feaa000c76.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-cbc5184943d860e12a8e30a1f8558e6e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-2bd489d59becf698b716923ddaeca4a6.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-cbc5184943d860e12a8e30a1f8558e6e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/downloadthis-1.9.1/downloadthis.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/core-js-2.5.3/shim.min.js"></script><script src="site_libs/react-18.2.0/react.min.js"></script><script src="site_libs/react-18.2.0/react-dom.min.js"></script><script src="site_libs/reactwidget-2.0.0/react-tools.js"></script><link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="site_libs/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="site_libs/reactable-binding-0.4.4/reactable.js"></script><link rel="stylesheet" href="assets/css/styles.css">
</head>
<body class="nav-sidebar floating nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./assets/icon.png" alt="" class="navbar-logo"></a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/sweltr/depth/"> <i class="bi bi-github" role="img" aria-label="SWELTR Depth">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./curate_ssu.html">B. Data Curation</a></li><li class="breadcrumb-item"><a href="./curate_amf.html">3c. AMF Data Curation</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">A. Processing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./primers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Primer Removal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lotus3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. ASV Inference</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">B. Data Curation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./curate_ssu.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3a. SSU Data Curation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./curate_its.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3b. ITS Data Curation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./curate_amf.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">3c. AMF Data Curation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./curate_oo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3d. Oomycete Data Curation</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
<li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#citable-resources" id="toc-citable-resources" class="nav-link" data-scroll-target="#citable-resources">Citable resources</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</li>
  <li>
<a href="#workflow" id="toc-workflow" class="nav-link" data-scroll-target="#workflow">Workflow</a>
  <ul class="collapse">
<li><a href="#required-packages" id="toc-required-packages" class="nav-link" data-scroll-target="#required-packages">Required Packages</a></li>
  <li><a href="#review-results" id="toc-review-results" class="nav-link" data-scroll-target="#review-results">Review Results</a></li>
  <li><a href="#sample-data" id="toc-sample-data" class="nav-link" data-scroll-target="#sample-data">Sample Data</a></li>
  <li>
<a href="#prep-data-for-microeco" id="toc-prep-data-for-microeco" class="nav-link" data-scroll-target="#prep-data-for-microeco">Prep Data for microeco</a>
  <ul class="collapse">
<li><a href="#a.-taxonomy-table" id="toc-a.-taxonomy-table" class="nav-link" data-scroll-target="#a.-taxonomy-table">A. Taxonomy Table</a></li>
  <li><a href="#b.-sequence-table" id="toc-b.-sequence-table" class="nav-link" data-scroll-target="#b.-sequence-table">B. Sequence Table</a></li>
  <li><a href="#c.-sample-table" id="toc-c.-sample-table" class="nav-link" data-scroll-target="#c.-sample-table">C. Sample Table</a></li>
  </ul>
</li>
  <li>
<a href="#create-a-microtable-object" id="toc-create-a-microtable-object" class="nav-link" data-scroll-target="#create-a-microtable-object">Create a Microtable Object</a>
  <ul class="collapse">
<li><a href="#d.-add-representative-sequence" id="toc-d.-add-representative-sequence" class="nav-link" data-scroll-target="#d.-add-representative-sequence">D. Add Representative Sequence</a></li>
  </ul>
</li>
  <li>
<a href="#curate-the-data-set" id="toc-curate-the-data-set" class="nav-link" data-scroll-target="#curate-the-data-set">Curate the Data Set</a>
  <ul class="collapse">
<li><a href="#remove-non-fungal-asvs" id="toc-remove-non-fungal-asvs" class="nav-link" data-scroll-target="#remove-non-fungal-asvs">Remove non-fungal ASVs</a></li>
  <li><a href="#remove-negative-controls-nc" id="toc-remove-negative-controls-nc" class="nav-link" data-scroll-target="#remove-negative-controls-nc">Remove Negative Controls (NC)</a></li>
  <li><a href="#remove-low-count-samples" id="toc-remove-low-count-samples" class="nav-link" data-scroll-target="#remove-low-count-samples">Remove Low-Count Samples</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li>Links</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/sweltr/depth/edit/main/curate_amf.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/sweltr/depth/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div><div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="https://doi.org/10.25573/data.16828063"><i class="bi bi-link-45deg"></i>Data</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./curate_ssu.html">B. Data Curation</a></li><li class="breadcrumb-item"><a href="./curate_amf.html">3c. AMF Data Curation</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">3c. AMF Data Curation</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
<p class="subtitle lead">Workflow for curating the ASV dataset–generating microeco &amp; phyloseq objects, removing spurious ASVs and low-count/negative control samples.</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="overview" class="level1"><h1>Overview</h1>
<p>On this page we use the phyloseq output from LotuS3 to format the otu, taxonomy, and sample data tables so we can create a microeco object. Once that is complete we curate the dataset by removing possible contaminants, negative control samples, NA kingdoms, and low-count samples.</p>
<section id="data" class="level2"><h2 class="anchored" data-anchor-id="data">Data</h2>
<p>All you need to run this workflow is the phyloseq object generated by the LotuS3 pipeline.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="fa-solid fa-download" aria-label="download"></i> &nbsp; phyloseq_amf.Rdata
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="#dnldts31902" onclick="fetch('data:application/x-gzip;base64,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').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'phyloseq_amf.Rdata'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
        });"><button class="btn btn-link downloadthis  " id="dnldts31902"><i class="bi bi-database"></i> LotuS3 phyloseq data </button></a></p>
</div>
</div>
<p></p>
</section><section id="citable-resources" class="level2"><h2 class="anchored" data-anchor-id="citable-resources">Citable resources</h2>
<section id="packages-used-in-this-workflow" class="level4"><h4 class="anchored" data-anchor-id="packages-used-in-this-workflow">Packages used in this workflow:</h4>
<ol type="1">
<li>R microeco package <span class="citation" data-cites="liu2021microeco">(<a href="#ref-liu2021microeco" role="doc-biblioref">Liu et al. 2021</a>)</span>.</li>
<li>phyloseq R package <span class="citation" data-cites="mcmurdie2013phyloseq">(<a href="#ref-mcmurdie2013phyloseq" role="doc-biblioref">McMurdie and Holmes 2013</a>)</span>.</li>
<li>miaverse <span class="citation" data-cites="felix2024mia">(<a href="#ref-felix2024mia" role="doc-biblioref">Borman et al. 2024</a>)</span> library(microeco) library(microbiome)</li>
</ol>
<p></p>
</section></section><section id="references" class="level2"><h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-felix2024mia" class="csl-entry" role="listitem">
Borman, Tuomas, Felix G. M. Ernst, Sudarshan A. Shetty, and Leo Lahti. 2024. <em>Mia: Microbiome Analysis</em>. <a href="https://doi.org/10.18129/B9.bioc.mia">https://doi.org/10.18129/B9.bioc.mia</a>.
</div>
<div id="ref-liu2021microeco" class="csl-entry" role="listitem">
Liu, Chi, Yaoming Cui, Xiangzhen Li, and Minjie Yao. 2021. <span>“Microeco: An r Package for Data Mining in Microbial Community Ecology.”</span> <em>FEMS Microbiology Ecology</em> 97 (2): fiaa255. <a href="https://doi.org/10.1038/s41596-025-01239-4">https://doi.org/10.1038/s41596-025-01239-4</a>.
</div>
<div id="ref-mcmurdie2013phyloseq" class="csl-entry" role="listitem">
McMurdie, Paul J, and Susan Holmes. 2013. <span>“Phyloseq: An r Package for Reproducible Interactive Analysis and Graphics of Microbiome Census Data.”</span> <em>PLoS One</em> 8 (4): e61217. <a href="https://doi.org/10.1371/journal.pone.0061217">https://doi.org/10.1371/journal.pone.0061217</a>.
</div>
</div>
</section></section><section id="workflow" class="level1"><h1>Workflow</h1>
<section id="required-packages" class="level2"><h2 class="anchored" data-anchor-id="required-packages">Required Packages</h2>
<div class="cell">
<details class="code-fold"><summary>Click here for required R packages.</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">919191</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ChiLiubio/microeco">microeco</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/microbiome/mia">mia</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217">phyloseq</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://microbiome.github.io/microbiome">microbiome</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="review-results" class="level2"><h2 class="anchored" data-anchor-id="review-results">Review Results</h2>
<p>The LotuS3 pipeline produces numerous output files but for our purposes there are four specific files we are interested in:</p>
<ol type="1">
<li><code>phyloseq.Rdata</code></li>
<li><code>OTU.fna</code></li>
<li><code>OTU.txt</code></li>
<li><code>hiera_BLAST.txt</code></li>
</ol>
<p>We will mainly work from the <code>phyloseq.Rdata</code> (renamed <code>phyloseq_amf.Rdata</code>) since this contains the OTU Table, Sample Data, Taxonomy Table, and Phylogenetic Tree. Note: a phylogenetic tree of microbial ASVs from short reads seems less than useful. Therefore, we will exclude this from the initial analysis.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"working_files/LOTUS3/amf/phyloseq_amf.Rdata"</span><span class="op">)</span></span>
<span><span class="va">physeq</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>phyloseq-class experiment-level object
otu_table()   OTU Table:          [ 883 taxa and 41 samples ]:
sample_data() Sample Data:        [ 41 samples by 14 sample variables ]:
tax_table()   Taxonomy Table:     [ 883 taxa by 7 taxonomic ranks ]:
phy_tree()    Phylogenetic Tree:  [ 883 tips and 881 internal nodes ]:</code></pre>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead><tr class="header">
<th>Metric</th>
<th>Results</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Min. number of reads</td>
<td>221</td>
</tr>
<tr class="even">
<td>Max. number of reads</td>
<td>52244</td>
</tr>
<tr class="odd">
<td>Total number of reads</td>
<td>1167700</td>
</tr>
<tr class="even">
<td>Average number of reads</td>
<td>28480</td>
</tr>
<tr class="odd">
<td>Median number of reads</td>
<td>31733</td>
</tr>
<tr class="even">
<td>Total ASVs</td>
<td>883</td>
</tr>
<tr class="odd">
<td>Number of singleton ASVs</td>
<td>2</td>
</tr>
<tr class="even">
<td>Any ASVs sum to 1 or less?</td>
<td>TRUE</td>
</tr>
<tr class="odd">
<td>Percent of ASVs that are singletons</td>
<td>0.227</td>
</tr>
<tr class="even">
<td>Sparsity</td>
<td>0.904</td>
</tr>
</tbody>
</table>
<p>In this next part of the workflow the goal is to create a <em>microtable object</em> using the R package <a href="https://chiliubio.github.io/microeco_tutorial/">microeco</a> <span class="citation" data-cites="liu2021microeco">(<a href="#ref-liu2021microeco" role="doc-biblioref">Liu et al. 2021</a>)</span>. The microtable will be used to store the ASV by sample data as well the taxonomic, fasta, and sample data in a single object. More on that in a moment.</p>
<p>We will also:</p>
<ul>
<li>Remove any ASVs without kingdom level classification.<br>
</li>
<li>Revome any contaminants (chloroplast, mitochondria, etc.).<br>
</li>
<li>Remove Negative Control (NC) samples.<br>
</li>
<li>Remove any low-count samples.</li>
</ul></section><section id="sample-data" class="level2"><h2 class="anchored" data-anchor-id="sample-data">Sample Data</h2>
<p>Before we begin, let’s create a summary table containing some basic sample metadata and the read count data. We want to inspect how total reads changed through the workflow. Table headers are as follows:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 78%">
</colgroup>
<thead><tr class="header">
<th>Header</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>SampleID</code></td>
<td>New sample ID based on plot, depth, treatment, &amp; pair</td>
</tr>
<tr class="even">
<td><code>Plot</code></td>
<td>Experimental plot ID</td>
</tr>
<tr class="odd">
<td><code>Treatment</code></td>
<td>Control vs warming</td>
</tr>
<tr class="even">
<td><code>Temp</code></td>
<td>Warming treatment temperature</td>
</tr>
<tr class="odd">
<td><code>Depth</code></td>
<td>Sampling depth in soil</td>
</tr>
<tr class="even">
<td><code>Pairing</code></td>
<td>Sample pairings</td>
</tr>
<tr class="odd">
<td><code>raw_rc</code></td>
<td>No.&nbsp;of raw reads</td>
</tr>
<tr class="even">
<td><code>cutadapt_rc</code></td>
<td>Read count after cutdapt</td>
</tr>
<tr class="odd">
<td><code>lotus3_rc</code></td>
<td>Read count after LotuS3 pipeline</td>
</tr>
<tr class="even">
<td><code>lotus3_asv</code></td>
<td>No.&nbsp;of ASVs</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Now I do some wrangling of the sample data to format it for downstream analysis. WAhat I want to do is first add read counts from different point in the workflow.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_otu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/otu_table-methods.html">otu_table</a></span><span class="op">(</span><span class="va">physeq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_otu_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">tmp_otu</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"SampleID"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tmp_otu_sum</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"lotus3_asv"</span></span>
<span><span class="va">tmp_read_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">tmp_otu</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"SampleID"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tmp_read_sum</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"lotus3_rc"</span></span>
<span><span class="va">tmp_track_reads</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span></span>
<span>    <span class="st">"files/CUTADAPT/amf_cutadapt_track.txt"</span>,</span>
<span>    header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">"\t"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_track_reads</span><span class="op">$</span><span class="va">SampleID</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span></span>
<span>  <span class="va">tmp_track_reads</span><span class="op">$</span><span class="va">SampleID</span>, <span class="st">"-"</span>, <span class="st">"_"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tmp_track_reads</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"raw_rc"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tmp_track_reads</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"cutadapt_rc"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then I want to merge this data with the sample metadata.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html">sample_data</a></span><span class="op">(</span><span class="va">physeq</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"SampleID"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_tab</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">tmp_samp</span>, <span class="va">tmp_track_reads</span>, by <span class="op">=</span> <span class="st">"SampleID"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">tmp_read_sum</span>, by <span class="op">=</span> <span class="st">"SampleID"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">tmp_otu_sum</span>, by <span class="op">=</span> <span class="st">"SampleID"</span><span class="op">)</span> </span>
<span><span class="va">sample_tab</span> <span class="op">&lt;-</span> <span class="va">sample_tab</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, </span>
<span>                <span class="fl">19</span>, <span class="fl">9</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">3</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_delim</a></span><span class="op">(</span><span class="va">sample_tab</span>, <span class="st">"files/CURATE/amf_sample_data_full.txt"</span>,</span>
<span>    delim <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_tab_trim</span> <span class="op">&lt;-</span> <span class="va">sample_tab</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">sample_tab_trim</span><span class="op">$</span><span class="va">per_reads_kept</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">sample_tab_trim</span><span class="op">$</span><span class="va">lotus3_rc</span><span class="op">/</span><span class="va">sample_tab_trim</span><span class="op">$</span><span class="va">raw_rc</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">sample_tab_trim</span> <span class="op">&lt;-</span> <span class="va">sample_tab_trim</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">per_reads_kept</span>, .before <span class="op">=</span> <span class="va">lotus3_asv</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p></p>
<div class="cell">
<div id="tbl-make-metadata-table-amf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-make-metadata-table-amf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Sample metadata including read changes at start and end of workflow.
</figcaption><div aria-describedby="tbl-make-metadata-table-amf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-75d662642cd4c45aefa9" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-75d662642cd4c45aefa9">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"SampleID":["P00_D00_000_NNN","P01_D00_010_W4A","P01_D10_020_W4A","P01_D20_050_W4A","P01_D50_100_W4A","P02_D00_010_C0A","P02_D10_020_C0A","P02_D20_050_C0A","P02_D50_100_C0A","P03_D00_010_W4B","P03_D10_020_W4B","P03_D20_050_W4B","P03_D50_100_W4B","P04_D00_010_C0B","P04_D10_020_C0B","P04_D20_050_C0B","P04_D50_100_C0B","P05_D00_010_W4C","P05_D10_020_W4C","P05_D20_050_W4C","P05_D50_100_W4C","P06_D00_010_C0C","P06_D10_020_C0C","P06_D20_050_C0C","P06_D50_100_C0C","P07_D00_010_W4D","P07_D10_020_W4D","P07_D20_050_W4D","P07_D50_100_W4D","P08_D00_010_C0D","P08_D10_020_C0D","P08_D20_050_C0D","P08_D50_100_C0D","P09_D00_010_W4E","P09_D10_020_W4E","P09_D20_050_W4E","P09_D50_100_W4E","P10_D00_010_C0E","P10_D10_020_C0E","P10_D20_050_C0E","P10_D50_100_C0E"],"Plot":["P00","P01","P01","P01","P01","P02","P02","P02","P02","P03","P03","P03","P03","P04","P04","P04","P04","P05","P05","P05","P05","P06","P06","P06","P06","P07","P07","P07","P07","P08","P08","P08","P08","P09","P09","P09","P09","P10","P10","P10","P10"],"Depth":["00_000","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100"],"Treatment":["Negative","Warm","Warm","Warm","Warm","Control","Control","Control","Control","Warm","Warm","Warm","Warm","Control","Control","Control","Control","Warm","Warm","Warm","Warm","Control","Control","Control","Control","Warm","Warm","Warm","Warm","Control","Control","Control","Control","Warm","Warm","Warm","Warm","Control","Control","Control","Control"],"Temp":["N","4","4","4","4","0","0","0","0","4","4","4","4","0","0","0","0","4","4","4","4","0","0","0","0","4","4","4","4","0","0","0","0","4","4","4","4","0","0","0","0"],"Pairing":["N","A","A","A","A","A","A","A","A","B","B","B","B","B","B","B","B","C","C","C","C","C","C","C","C","D","D","D","D","D","D","D","D","E","E","E","E","E","E","E","E"],"raw_rc":[47622,49965,22904,394,7014,24935,19389,63388,30114,51320,44859,37422,38671,48228,38244,40042,35885,45254,42162,21806,11804,50919,46097,49338,16312,42163,53157,32234,33024,39249,41393,33336,37368,46685,43854,36702,12872,46375,40900,26064,24518],"cutadapt_rc":[29518,48866,22346,281,6817,24026,18764,62757,29834,50677,44401,37004,38272,47743,37861,39383,32509,44829,35611,21611,11686,50379,45763,48923,16170,41649,51899,31892,32668,39009,40954,33011,31983,44957,43536,26997,4003,45952,40630,25766,18876],"lotus3_rc":[23941,37078,19128,221,5691,20077,15942,52244,25653,39935,37830,31733,32641,39828,32152,32667,27786,37990,30352,18483,10192,39810,39087,40591,14165,35343,39748,27651,28039,33275,35481,28657,27881,33264,36805,23364,3442,35538,35204,22433,16358],"per_reads_kept":[0.503,0.742,0.835,0.561,0.811,0.805,0.822,0.824,0.852,0.778,0.843,0.848,0.844,0.826,0.841,0.816,0.774,0.839,0.72,0.848,0.863,0.782,0.848,0.823,0.868,0.838,0.748,0.858,0.849,0.848,0.857,0.86,0.746,0.713,0.839,0.637,0.267,0.766,0.861,0.861,0.667],"lotus3_asv":[63,213,53,13,49,168,63,97,31,144,82,39,53,230,61,158,56,86,79,25,20,200,106,115,23,77,209,41,31,63,63,40,30,165,72,40,21,292,74,24,23]},"columns":[{"id":"SampleID","name":"SampleID","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["P00_D00_000_NNN","P01_D00_010_W4A","P01_D10_020_W4A","P01_D20_050_W4A","P01_D50_100_W4A","P02_D00_010_C0A","P02_D10_020_C0A","P02_D20_050_C0A","P02_D50_100_C0A","P03_D00_010_W4B","P03_D10_020_W4B","P03_D20_050_W4B","P03_D50_100_W4B","P04_D00_010_C0B","P04_D10_020_C0B","P04_D20_050_C0B","P04_D50_100_C0B","P05_D00_010_W4C","P05_D10_020_W4C","P05_D20_050_W4C","P05_D50_100_W4C","P06_D00_010_C0C","P06_D10_020_C0C","P06_D20_050_C0C","P06_D50_100_C0C","P07_D00_010_W4D","P07_D10_020_W4D","P07_D20_050_W4D","P07_D50_100_W4D","P08_D00_010_C0D","P08_D10_020_C0D","P08_D20_050_C0D","P08_D50_100_C0D","P09_D00_010_W4E","P09_D10_020_W4E","P09_D20_050_W4E","P09_D50_100_W4E","P10_D00_010_C0E","P10_D10_020_C0E","P10_D20_050_C0E","P10_D50_100_C0E"],"header":"SampleID","align":"left","footerStyle":{"fontWeight":"bold"},"minWidth":150,"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"id":"Plot","name":"Plot","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["P00","P01","P01","P01","P01","P02","P02","P02","P02","P03","P03","P03","P03","P04","P04","P04","P04","P05","P05","P05","P05","P06","P06","P06","P06","P07","P07","P07","P07","P08","P08","P08","P08","P09","P09","P09","P09","P10","P10","P10","P10"],"header":"Plot","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"Depth","name":"Depth","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["00_000","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100","00_010","10_020","20_050","50_100"],"header":"Depth","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"Treatment","name":"Treatment","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["Negative","Warm","Warm","Warm","Warm","Control","Control","Control","Control","Warm","Warm","Warm","Warm","Control","Control","Control","Control","Warm","Warm","Warm","Warm","Control","Control","Control","Control","Warm","Warm","Warm","Warm","Control","Control","Control","Control","Warm","Warm","Warm","Warm","Control","Control","Control","Control"],"header":"Treatment","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"Temp","name":"Temp","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["N","4","4","4","4","0","0","0","0","4","4","4","4","0","0","0","0","4","4","4","4","0","0","0","0","4","4","4","4","0","0","0","0","4","4","4","4","0","0","0","0"],"header":"Temp","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"Pairing","name":"Pairing","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["N","A","A","A","A","A","A","A","A","B","B","B","B","B","B","B","B","C","C","C","C","C","C","C","C","D","D","D","D","D","D","D","D","E","E","E","E","E","E","E","E"],"header":"Pairing","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"raw_rc","name":"raw rc","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["47622","49965","22904","394","7014","24935","19389","63388","30114","51320","44859","37422","38671","48228","38244","40042","35885","45254","42162","21806","11804","50919","46097","49338","16312","42163","53157","32234","33024","39249","41393","33336","37368","46685","43854","36702","12872","46375","40900","26064","24518"],"header":"raw rc","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"cutadapt_rc","name":"cutadapt rc","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["29518","48866","22346","281","6817","24026","18764","62757","29834","50677","44401","37004","38272","47743","37861","39383","32509","44829","35611","21611","11686","50379","45763","48923","16170","41649","51899","31892","32668","39009","40954","33011","31983","44957","43536","26997","4003","45952","40630","25766","18876"],"header":"cutadapt rc","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"lotus3_rc","name":"lotus3_rc","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["23941","37078","19128","221","5691","20077","15942","52244","25653","39935","37830","31733","32641","39828","32152","32667","27786","37990","30352","18483","10192","39810","39087","40591","14165","35343","39748","27651","28039","33275","35481","28657","27881","33264","36805","23364","3442","35538","35204","22433","16358"],"header":"lotus3 rc","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"per_reads_kept","name":"per reads retain","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["0.503","0.742","0.835","0.561","0.811","0.805","0.822","0.824","0.852","0.778","0.843","0.848","0.844","0.826","0.841","0.816","0.774","0.839","0.72","0.848","0.863","0.782","0.848","0.823","0.868","0.838","0.748","0.858","0.849","0.848","0.857","0.86","0.746","0.713","0.839","0.637","0.267","0.766","0.861","0.861","0.667"],"header":"per reads retain","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"lotus3_asv","name":"lotus3_asv","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["63","213","53","13","49","168","63","97","31","144","82","39","53","230","61","158","56","86","79","25","20","200","106","115","23","77","209","41","31","63","63","40","30","165","72","40","21","292","74","24","23"],"header":"lotus3 asv","align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,41],"highlight":true,"bordered":true,"striped":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"e8b6e145646cb63088fceb4efe46f86f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</figure>
</div>
</div>
<p></p>
<p><a href="#shrimp_md" onclick="fetch('data:text/plain;base64,U2FtcGxlSUQJUGxvdAlEZXB0aAlUcmVhdG1lbnQJVGVtcAlQYWlyaW5nCXJhd19yYwljdXRhZGFwdF9yYwlsb3R1czNfcmMJcGVyX3JlYWRzX2tlcHQJbG90dXMzX2FzdgpQMDBfRDAwXzAwMF9OTk4JUDAwCTAwXzAwMAlOZWdhdGl2ZQlOCU4JNDc2MjIJMjk1MTgJMjM5NDEJMC41MDMJNjMKUDAxX0QwMF8wMTBfVzRBCVAwMQkwMF8wMTAJV2FybQk0CUEJNDk5NjUJNDg4NjYJMzcwNzgJMC43NDIJMjEzClAwMV9EMTBfMDIwX1c0QQlQMDEJMTBfMDIwCVdhcm0JNAlBCTIyOTA0CTIyMzQ2CTE5MTI4CTAuODM1CTUzClAwMV9EMjBfMDUwX1c0QQlQMDEJMjBfMDUwCVdhcm0JNAlBCTM5NAkyODEJMjIxCTAuNTYxCTEzClAwMV9ENTBfMTAwX1c0QQlQMDEJNTBfMTAwCVdhcm0JNAlBCTcwMTQJNjgxNwk1NjkxCTAuODExCTQ5ClAwMl9EMDBfMDEwX0MwQQlQMDIJMDBfMDEwCUNvbnRyb2wJMAlBCTI0OTM1CTI0MDI2CTIwMDc3CTAuODA1CTE2OApQMDJfRDEwXzAyMF9DMEEJUDAyCTEwXzAyMAlDb250cm9sCTAJQQkxOTM4OQkxODc2NAkxNTk0MgkwLjgyMgk2MwpQMDJfRDIwXzA1MF9DMEEJUDAyCTIwXzA1MAlDb250cm9sCTAJQQk2MzM4OAk2Mjc1Nwk1MjI0NAkwLjgyNAk5NwpQMDJfRDUwXzEwMF9DMEEJUDAyCTUwXzEwMAlDb250cm9sCTAJQQkzMDExNAkyOTgzNAkyNTY1MwkwLjg1MgkzMQpQMDNfRDAwXzAxMF9XNEIJUDAzCTAwXzAxMAlXYXJtCTQJQgk1MTMyMAk1MDY3NwkzOTkzNQkwLjc3OAkxNDQKUDAzX0QxMF8wMjBfVzRCCVAwMwkxMF8wMjAJV2FybQk0CUIJNDQ4NTkJNDQ0MDEJMzc4MzAJMC44NDMJODIKUDAzX0QyMF8wNTBfVzRCCVAwMwkyMF8wNTAJV2FybQk0CUIJMzc0MjIJMzcwMDQJMzE3MzMJMC44NDgJMzkKUDAzX0Q1MF8xMDBfVzRCCVAwMwk1MF8xMDAJV2FybQk0CUIJMzg2NzEJMzgyNzIJMzI2NDEJMC44NDQJNTMKUDA0X0QwMF8wMTBfQzBCCVAwNAkwMF8wMTAJQ29udHJvbAkwCUIJNDgyMjgJNDc3NDMJMzk4MjgJMC44MjYJMjMwClAwNF9EMTBfMDIwX0MwQglQMDQJMTBfMDIwCUNvbnRyb2wJMAlCCTM4MjQ0CTM3ODYxCTMyMTUyCTAuODQxCTYxClAwNF9EMjBfMDUwX0MwQglQMDQJMjBfMDUwCUNvbnRyb2wJMAlCCTQwMDQyCTM5MzgzCTMyNjY3CTAuODE2CTE1OApQMDRfRDUwXzEwMF9DMEIJUDA0CTUwXzEwMAlDb250cm9sCTAJQgkzNTg4NQkzMjUwOQkyNzc4NgkwLjc3NAk1NgpQMDVfRDAwXzAxMF9XNEMJUDA1CTAwXzAxMAlXYXJtCTQJQwk0NTI1NAk0NDgyOQkzNzk5MAkwLjgzOQk4NgpQMDVfRDEwXzAyMF9XNEMJUDA1CTEwXzAyMAlXYXJtCTQJQwk0MjE2MgkzNTYxMQkzMDM1MgkwLjcyCTc5ClAwNV9EMjBfMDUwX1c0QwlQMDUJMjBfMDUwCVdhcm0JNAlDCTIxODA2CTIxNjExCTE4NDgzCTAuODQ4CTI1ClAwNV9ENTBfMTAwX1c0QwlQMDUJNTBfMTAwCVdhcm0JNAlDCTExODA0CTExNjg2CTEwMTkyCTAuODYzCTIwClAwNl9EMDBfMDEwX0MwQwlQMDYJMDBfMDEwCUNvbnRyb2wJMAlDCTUwOTE5CTUwMzc5CTM5ODEwCTAuNzgyCTIwMApQMDZfRDEwXzAyMF9DMEMJUDA2CTEwXzAyMAlDb250cm9sCTAJQwk0NjA5Nwk0NTc2MwkzOTA4NwkwLjg0OAkxMDYKUDA2X0QyMF8wNTBfQzBDCVAwNgkyMF8wNTAJQ29udHJvbAkwCUMJNDkzMzgJNDg5MjMJNDA1OTEJMC44MjMJMTE1ClAwNl9ENTBfMTAwX0MwQwlQMDYJNTBfMTAwCUNvbnRyb2wJMAlDCTE2MzEyCTE2MTcwCTE0MTY1CTAuODY4CTIzClAwN19EMDBfMDEwX1c0RAlQMDcJMDBfMDEwCVdhcm0JNAlECTQyMTYzCTQxNjQ5CTM1MzQzCTAuODM4CTc3ClAwN19EMTBfMDIwX1c0RAlQMDcJMTBfMDIwCVdhcm0JNAlECTUzMTU3CTUxODk5CTM5NzQ4CTAuNzQ4CTIwOQpQMDdfRDIwXzA1MF9XNEQJUDA3CTIwXzA1MAlXYXJtCTQJRAkzMjIzNAkzMTg5MgkyNzY1MQkwLjg1OAk0MQpQMDdfRDUwXzEwMF9XNEQJUDA3CTUwXzEwMAlXYXJtCTQJRAkzMzAyNAkzMjY2OAkyODAzOQkwLjg0OQkzMQpQMDhfRDAwXzAxMF9DMEQJUDA4CTAwXzAxMAlDb250cm9sCTAJRAkzOTI0OQkzOTAwOQkzMzI3NQkwLjg0OAk2MwpQMDhfRDEwXzAyMF9DMEQJUDA4CTEwXzAyMAlDb250cm9sCTAJRAk0MTM5Mwk0MDk1NAkzNTQ4MQkwLjg1Nwk2MwpQMDhfRDIwXzA1MF9DMEQJUDA4CTIwXzA1MAlDb250cm9sCTAJRAkzMzMzNgkzMzAxMQkyODY1NwkwLjg2CTQwClAwOF9ENTBfMTAwX0MwRAlQMDgJNTBfMTAwCUNvbnRyb2wJMAlECTM3MzY4CTMxOTgzCTI3ODgxCTAuNzQ2CTMwClAwOV9EMDBfMDEwX1c0RQlQMDkJMDBfMDEwCVdhcm0JNAlFCTQ2Njg1CTQ0OTU3CTMzMjY0CTAuNzEzCTE2NQpQMDlfRDEwXzAyMF9XNEUJUDA5CTEwXzAyMAlXYXJtCTQJRQk0Mzg1NAk0MzUzNgkzNjgwNQkwLjgzOQk3MgpQMDlfRDIwXzA1MF9XNEUJUDA5CTIwXzA1MAlXYXJtCTQJRQkzNjcwMgkyNjk5NwkyMzM2NAkwLjYzNwk0MApQMDlfRDUwXzEwMF9XNEUJUDA5CTUwXzEwMAlXYXJtCTQJRQkxMjg3Mgk0MDAzCTM0NDIJMC4yNjcJMjEKUDEwX0QwMF8wMTBfQzBFCVAxMAkwMF8wMTAJQ29udHJvbAkwCUUJNDYzNzUJNDU5NTIJMzU1MzgJMC43NjYJMjkyClAxMF9EMTBfMDIwX0MwRQlQMTAJMTBfMDIwCUNvbnRyb2wJMAlFCTQwOTAwCTQwNjMwCTM1MjA0CTAuODYxCTc0ClAxMF9EMjBfMDUwX0MwRQlQMTAJMjBfMDUwCUNvbnRyb2wJMAlFCTI2MDY0CTI1NzY2CTIyNDMzCTAuODYxCTI0ClAxMF9ENTBfMTAwX0MwRQlQMTAJNTBfMTAwCUNvbnRyb2wJMAlFCTI0NTE4CTE4ODc2CTE2MzU4CTAuNjY3CTIzCg==').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'amf_sample_data_with_rc.txt'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
        });"><button class="btn btn-primary downloadthis  data-button" id="shrimp_md"><i class="bi bi-table"></i> Download sample metadata </button></a></p>
</section><section id="prep-data-for-microeco" class="level2"><h2 class="anchored" data-anchor-id="prep-data-for-microeco">Prep Data for microeco</h2>
<p>Like any tool, the microeco package needs the data in a specific form. I formatted our data to match the mock data in this section, <a href="https://chiliubio.github.io/microeco_tutorial/basic-class.html#prepare-the-example-data">microeco</a> tutorial.</p>
<section id="a.-taxonomy-table" class="level3"><h3 class="anchored" data-anchor-id="a.-taxonomy-table">A. Taxonomy Table</h3>
<p>Here is what the taxonomy table looks like in the dataset.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_tax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html">tax_table</a></span><span class="op">(</span><span class="va">physeq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_tax</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>       Domain    Phylum       Class          Order
ASV7   Eukaryota Mucoromycota Glomeromycetes Glomerales
ASV17  Eukaryota Mucoromycota Glomeromycetes Glomerales
ASV245 Eukaryota Mucoromycota Glomeromycetes Glomerales
ASV214 Eukaryota Mucoromycota Glomeromycetes Glomerales
ASV401 Eukaryota Mucoromycota Glomeromycetes Glomerales
ASV57  Eukaryota Mucoromycota Glomeromycetes Glomerales</code></pre>
<p>Next we need to add rank definitions (e.g., <code>k__</code>, <code>p__</code>, etc.) to each classification.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_tax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html">tax_table</a></span><span class="op">(</span><span class="va">physeq</span><span class="op">)</span><span class="op">)</span>   </span>
<span><span class="va">tmp_tax</span> <span class="op">&lt;-</span> <span class="va">tmp_tax</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"Kingdom"</span> <span class="op">=</span> <span class="st">"Domain"</span><span class="op">)</span></span>
<span><span class="va">tmp_tax</span> <span class="op">&lt;-</span> <span class="va">tmp_tax</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span><span class="op">(</span><span class="op">~</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"\\?"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_tax</span><span class="op">$</span><span class="va">Kingdom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"k"</span>, <span class="va">tmp_tax</span><span class="op">$</span><span class="va">Kingdom</span>, sep <span class="op">=</span> <span class="st">"__"</span><span class="op">)</span></span>
<span><span class="va">tmp_tax</span><span class="op">$</span><span class="va">Phylum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="va">tmp_tax</span><span class="op">$</span><span class="va">Phylum</span>, sep <span class="op">=</span> <span class="st">"__"</span><span class="op">)</span></span>
<span><span class="va">tmp_tax</span><span class="op">$</span><span class="va">Class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="va">tmp_tax</span><span class="op">$</span><span class="va">Class</span>, sep <span class="op">=</span> <span class="st">"__"</span><span class="op">)</span></span>
<span><span class="va">tmp_tax</span><span class="op">$</span><span class="va">Order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="va">tmp_tax</span><span class="op">$</span><span class="va">Order</span>, sep <span class="op">=</span> <span class="st">"__"</span><span class="op">)</span></span>
<span><span class="va">tmp_tax</span><span class="op">$</span><span class="va">Family</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="va">tmp_tax</span><span class="op">$</span><span class="va">Family</span>, sep <span class="op">=</span> <span class="st">"__"</span><span class="op">)</span></span>
<span><span class="va">tmp_tax</span><span class="op">$</span><span class="va">Genus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"g"</span>, <span class="va">tmp_tax</span><span class="op">$</span><span class="va">Genus</span>, sep <span class="op">=</span> <span class="st">"__"</span><span class="op">)</span></span>
<span><span class="va">tmp_tax</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="va">tmp_tax</span><span class="op">$</span><span class="va">Species</span>, sep <span class="op">=</span> <span class="st">"__"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now the final, modified taxonomy table.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_tax</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>       Kingdom      Phylum          Class             Order
ASV7   k__Eukaryota p__Mucoromycota c__Glomeromycetes o__Glomerales
ASV17  k__Eukaryota p__Mucoromycota c__Glomeromycetes o__Glomerales
ASV245 k__Eukaryota p__Mucoromycota c__Glomeromycetes o__Glomerales
ASV214 k__Eukaryota p__Mucoromycota c__Glomeromycetes o__Glomerales
ASV401 k__Eukaryota p__Mucoromycota c__Glomeromycetes o__Glomerales
ASV57  k__Eukaryota p__Mucoromycota c__Glomeromycetes o__Glomerales</code></pre>
</section><section id="b.-sequence-table" class="level3"><h3 class="anchored" data-anchor-id="b.-sequence-table">B. Sequence Table</h3>
<p>Here is what the sequence table looks like in the dataset.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_otu</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>       P00_D00_000_NNN P01_D00_010_W4A P01_D10_020_W4A
ASV7              1340               4             657 
ASV17                4               0               0 
ASV245               0               0               0 
ASV214               0               0               0 
ASV401               0               0               0 
ASV57              699               0               0 </code></pre>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">tmp_otu</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">tmp_tax</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>[1] TRUE</code></pre>
</section><section id="c.-sample-table" class="level3"><h3 class="anchored" data-anchor-id="c.-sample-table">C. Sample Table</h3>
<p>Here is what the sample table looks like.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sample_tab</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       SampleID Plot  Depth Treatment Temp Pairing
P00_D00_000_NNN P00_D00_000_NNN  P00 00_000  Negative    N       N
P01_D00_010_W4A P01_D00_010_W4A  P01 00_010      Warm    4       A
P01_D10_020_W4A P01_D10_020_W4A  P01 10_020      Warm    4       A
P01_D20_050_W4A P01_D20_050_W4A  P01 20_050      Warm    4       A
P01_D50_100_W4A P01_D50_100_W4A  P01 50_100      Warm    4       A
P02_D00_010_C0A P02_D00_010_C0A  P02 00_010   Control    0       A</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sample_tab</span> <span class="op">&lt;-</span> <span class="va">sample_tab</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span><span class="st">"SampleID"</span><span class="op">)</span></span>
<span><span class="va">sample_tab</span><span class="op">$</span><span class="va">SampleID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sample_tab</span><span class="op">)</span></span>
<span><span class="va">sample_tab</span> <span class="op">&lt;-</span> <span class="va">sample_tab</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">SampleID</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="create-a-microtable-object" class="level2"><h2 class="anchored" data-anchor-id="create-a-microtable-object">Create a Microtable Object</h2>
<p>With these three files in hand we are now ready to create a <a href="https://chiliubio.github.io/microeco_tutorial/basic-class.html">microtable object</a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <a href="https://chiliubio.github.io/microeco_tutorial/basic-class.html">microtable object</a> contains an ASV table (taxa abundances), sample metadata, and taxonomy table (mapping between ASVs and higher-level taxonomic classifications). It can also contain a phylogenetic tree of ASVs as well as representative sequences of each ASV.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sample_tab</span> <span class="op">&lt;-</span> <span class="va">sample_tab</span></span>
<span><span class="va">tax_tab</span> <span class="op">&lt;-</span> <span class="va">tmp_tax</span></span>
<span><span class="va">otu_tab</span> <span class="op">&lt;-</span> <span class="va">tmp_otu</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_me</span> <span class="op">&lt;-</span> <span class="va"><a href="https://rdrr.io/pkg/microeco/man/microtable.html">microtable</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>sample_table <span class="op">=</span> <span class="va">sample_tab</span>, </span>
<span>                         otu_table <span class="op">=</span> <span class="va">otu_tab</span>, </span>
<span>                         tax_table <span class="op">=</span> <span class="va">tax_tab</span><span class="op">)</span></span>
<span><span class="va">tmp_me</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>microtable-class object:
sample_table have 41 rows and 19 columns
otu_table have 883 rows and 41 columns
tax_table have 883 rows and 7 columns</code></pre>
<section id="d.-add-representative-sequence" class="level3"><h3 class="anchored" data-anchor-id="d.-add-representative-sequence">D. Add Representative Sequence</h3>
<p>We can also add representative sequences for each OTU/ASV. For this step, we can simply grab the sequences from the row names of the DADA2 taxonomy object loaded above.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rep_fasta</span> <span class="op">&lt;-</span> <span class="fu">Biostrings</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-io.html">readDNAStringSet</a></span><span class="op">(</span><span class="st">"working_files/LOTUS3/amf/OTU.fna"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">tmp_me</span><span class="op">$</span><span class="va">tax_table</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">tmp_me</span><span class="op">$</span><span class="va">otu_table</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>[1] TRUE</code></pre>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_fasta_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">rep_fasta</span><span class="op">)</span></span>
<span><span class="va">tmp_rep_fasta</span> <span class="op">&lt;-</span> <span class="va">rep_fasta</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">tmp_me</span><span class="op">$</span><span class="va">tax_table</span><span class="op">)</span>, <span class="va">tmp_fasta_names</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">rep_fasta</span> <span class="op">&lt;-</span> <span class="va">tmp_rep_fasta</span></span>
<span><span class="va">tmp_me</span><span class="op">$</span><span class="va">rep_fasta</span> <span class="op">&lt;-</span> <span class="va">rep_fasta</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">tmp_me</span><span class="op">$</span><span class="va">tax_table</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">rep_fasta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_me</span><span class="op">$</span><span class="fu">tidy_dataset</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>[1] TRUE</code></pre>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">me_asv_raw</span> <span class="op">&lt;-</span> <span class="fu">microeco</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microeco/man/clone.html">clone</a></span><span class="op">(</span><span class="va">tmp_me</span><span class="op">)</span></span>
<span><span class="va">me_asv_raw</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>microtable-class object:
sample_table have 41 rows and 19 columns
otu_table have 883 rows and 41 columns
tax_table have 883 rows and 7 columns
rep_fasta have 883 sequences</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>The microeco object <code>me_asv_raw</code> contains all data from the LotuS3 pipeline, before any dataset curation.</p>
</blockquote>
</section></section><section id="curate-the-data-set" class="level2"><h2 class="anchored" data-anchor-id="curate-the-data-set">Curate the Data Set</h2>
<p>Pretty much the last thing to do is remove unwanted taxa, negative controls, and low-count samples.</p>
<section id="remove-non-fungal-asvs" class="level3"><h3 class="anchored" data-anchor-id="remove-non-fungal-asvs">Remove non-fungal ASVs</h3>
<p>First we can have a quick look at the kingdom and phylum level classifications to see what we are dealing with.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_k</span> <span class="op">&lt;-</span> <span class="va">me_asv_raw</span><span class="op">$</span><span class="va">tax_table</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">distinct</span><span class="op">(</span><span class="va">Kingdom</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_p</span> <span class="op">&lt;-</span> <span class="va">me_asv_raw</span><span class="op">$</span><span class="va">tax_table</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">distinct</span><span class="op">(</span><span class="va">Phylum</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>-------KINGDOM------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>k__Eukaryota
k__</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-------PHYLUM------------------</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>p__Mucoromycota
p__
p__Ascomycota
p__Basidiomycota
p__Cnidaria
p__Arthropoda
p__Ciliophora
p__Porifera
p__NAMAKO-1
p__Kathablepharidae
p__Gracilipodida
p__Peronosporomycetes
p__Nucleariidae and Fonticula group
p__Zoopagomycota
p__LKM15
p__Aphelidea
p__Chytridiomycota
p__Cercozoa
p__Cryptomycota
p__Neocallimastigomycota</code></pre>
</div>
</div>
<ol type="1">
<li><p>The first thing to notice in at the kingdom level we only have Eukaryota and unclassified (or NA). We can remove anything with the NA at the kingdom level.</p></li>
<li><p>At the phylum level, we can see several non-fungal taxa as well as unclassified. We can remove any non-fungal taxa as well as any phylum level NAs.</p></li>
</ol>
<p>The easiest thing to do is keep everything we want–in other words, all fungal taxa.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_no_na</span> <span class="op">&lt;-</span> <span class="fu">microeco</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microeco/man/clone.html">clone</a></span><span class="op">(</span><span class="va">tmp_me</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_no_na</span><span class="op">$</span><span class="va">tax_table</span> <span class="op">%&lt;&gt;%</span> </span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Kingdom</span> <span class="op">==</span> <span class="st">"k__Eukaryota"</span><span class="op">)</span></span>
<span><span class="va">tmp_no_na</span><span class="op">$</span><span class="va">tax_table</span> <span class="op">%&lt;&gt;%</span> </span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">Phylum</span> <span class="op">==</span> <span class="st">"p__Mucoromycota"</span> <span class="op">|</span> </span>
<span>               <span class="va">Phylum</span> <span class="op">==</span>  <span class="st">"p__Ascomycota"</span> <span class="op">|</span> </span>
<span>               <span class="va">Phylum</span> <span class="op">==</span>  <span class="st">"p__Basidiomycota"</span> <span class="op">|</span> </span>
<span>               <span class="va">Phylum</span> <span class="op">==</span>  <span class="st">"p__Peronosporomycetes"</span> <span class="op">|</span> </span>
<span>               <span class="va">Phylum</span> <span class="op">==</span>  <span class="st">"p__Zoopagomycota"</span> <span class="op">|</span> </span>
<span>               <span class="va">Phylum</span> <span class="op">==</span>  <span class="st">"p__LKM15"</span> <span class="op">|</span> </span>
<span>               <span class="va">Phylum</span> <span class="op">==</span>  <span class="st">"p__Aphelidea"</span> <span class="op">|</span> </span>
<span>               <span class="va">Phylum</span> <span class="op">==</span>  <span class="st">"p__Chytridiomycota"</span> <span class="op">|</span> </span>
<span>               <span class="va">Phylum</span> <span class="op">==</span>  <span class="st">"p__Cryptomycota"</span> <span class="op">|</span> </span>
<span>               <span class="va">Phylum</span> <span class="op">==</span>  <span class="st">"p__Neocallimastigomycota"</span><span class="op">)</span>  </span>
<span><span class="va">tmp_no_na</span><span class="op">$</span><span class="fu">tidy_dataset</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">me_asv_no_na</span> <span class="op">&lt;-</span> <span class="fu">microeco</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microeco/man/clone.html">clone</a></span><span class="op">(</span><span class="va">tmp_no_na</span><span class="op">)</span></span>
<span><span class="va">me_asv_no_na</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>microtable-class object:
sample_table have 41 rows and 19 columns
otu_table have 578 rows and 41 columns
tax_table have 578 rows and 7 columns
rep_fasta have 578 sequences</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>The microeco object <code>me_asv_no_na</code> conatins only ASVs classified as Fungi.</p>
</blockquote>
</section><section id="remove-negative-controls-nc" class="level3"><h3 class="anchored" data-anchor-id="remove-negative-controls-nc">Remove Negative Controls (NC)</h3>
<p>Now we need to remove the NC samples <em>and</em> ASVs found in those sample. We first identified all ASVs that were present in at least one NC sample represented by at least 1 read. We did this by sub-setting the NC samples from the new microtable object.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_nc</span> <span class="op">&lt;-</span> <span class="fu">microeco</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microeco/man/clone.html">clone</a></span><span class="op">(</span><span class="va">tmp_no_na</span><span class="op">)</span></span>
<span><span class="va">tmp_nc</span><span class="op">$</span><span class="va">sample_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">tmp_nc</span><span class="op">$</span><span class="va">sample_table</span>, <span class="va">Treatment</span> <span class="op">==</span> <span class="st">"Negative"</span><span class="op">)</span></span>
<span><span class="va">tmp_nc</span><span class="op">$</span><span class="fu">tidy_dataset</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>527 taxa with 0 abundance are removed from the otu_table ...</code></pre>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">me_asv_nc</span> <span class="op">&lt;-</span> <span class="fu">microeco</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microeco/man/clone.html">clone</a></span><span class="op">(</span><span class="va">tmp_nc</span><span class="op">)</span></span>
<span><span class="va">me_asv_nc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>The microeco object <code>me_asv_nc</code> conatins only the negative control sample(s) and associated ASVs.</p>
</blockquote>
<p>Looks like there are 51 ASVs in the NC samples from a total of 16700 reads.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nc_asvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">tmp_nc</span><span class="op">$</span><span class="va">tax_table</span><span class="op">)</span></span>
<span><span class="va">nc_asvs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ASV7"   "ASV17"  "ASV57"  "ASV265" "ASV231" "ASV304" "ASV275" "ASV550"
 [9] "ASV380" "ASV300" "ASV4"   "ASV633" "ASV462" "ASV12"  "ASV533" "ASV98" 
[17] "ASV1"   "ASV880" "ASV130" "ASV71"  "ASV28"  "ASV347" "ASV191" "ASV51" 
[25] "ASV471" "ASV110" "ASV278" "ASV631" "ASV155" "ASV21"  "ASV229" "ASV501"
[33] "ASV120" "ASV2"   "ASV460" "ASV646" "ASV158" "ASV145" "ASV93"  "ASV276"
[41] "ASV364" "ASV638" "ASV63"  "ASV212" "ASV392" "ASV474" "ASV102" "ASV173"
[49] "ASV655" "ASV23"  "ASV58" </code></pre>
</div>
</div>
<p>There are 51 ASVs found in the NC sample. ASVs are numbered in order by total abundance in the data set so we know that many of the ASVs in the NC samples are not particularly abundant in the dataset. That said, there are numerous low number ASVs (e.g.&nbsp;ASV1, ASV2, ASV7, etc.) that are found in NC samples.</p>
<p>We can look at the abundance of these ASVs across all samples and compare it to the NC. This takes a bit of wrangling.</p>
<p>Essentially, for each ASV, the code below calculates:</p>
<ul>
<li>The total number of NC samples containing at least 1 read.<br>
</li>
<li>The total number of reads in NC samples.<br>
</li>
<li>The total number of non-NC samples containing at least 1 read.<br>
</li>
<li>The total number of reads in non-NC samples.<br>
</li>
<li>The percent of reads in the NC samples and the percent of NC samples containing reads.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_rem_nc</span> <span class="op">&lt;-</span> <span class="fu">microeco</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microeco/man/clone.html">clone</a></span><span class="op">(</span><span class="va">tmp_no_na</span><span class="op">)</span></span>
<span><span class="va">tmp_rem_nc_df</span> <span class="op">&lt;-</span> <span class="va">tmp_rem_nc</span><span class="op">$</span><span class="va">otu_table</span></span>
<span><span class="va">tmp_rem_nc_df</span> <span class="op">&lt;-</span> <span class="va">tmp_rem_nc_df</span> <span class="op">%&gt;%</span> </span>
<span>                 <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">tmp_rem_nc_df</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">nc_asvs</span><span class="op">)</span></span>
<span><span class="va">tmp_rem_nc_df</span> <span class="op">&lt;-</span> <span class="va">tmp_rem_nc_df</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"ASV_ID"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_rem_nc_df</span> <span class="op">&lt;-</span> <span class="va">tmp_rem_nc_df</span>  <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>total_reads_NC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"NNN"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>         .after <span class="op">=</span> <span class="st">"ASV_ID"</span><span class="op">)</span></span>
<span><span class="va">tmp_rem_nc_df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">tmp_rem_nc_df</span>, <span class="op">-</span><span class="fu">contains</span><span class="op">(</span><span class="st">"NNN"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_rem_nc_df</span> <span class="op">&lt;-</span> <span class="va">tmp_rem_nc_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>total_reads_samps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">.</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">tmp_rem_nc_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                .after <span class="op">=</span> <span class="st">"total_reads_NC"</span><span class="op">)</span></span>
<span><span class="va">tmp_rem_nc_df</span><span class="op">[</span>, <span class="fl">4</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">tmp_rem_nc_df</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">tmp_rem_nc_df</span> <span class="op">&lt;-</span> <span class="va">tmp_rem_nc_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>perc_in_neg <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="op">(</span></span>
<span>    <span class="va">total_reads_NC</span> <span class="op">/</span> <span class="op">(</span><span class="va">total_reads_NC</span> <span class="op">+</span> <span class="va">total_reads_samps</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                .after <span class="op">=</span> <span class="st">"total_reads_samps"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_rem_nc_df</span><span class="op">$</span><span class="va">perc_in_neg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tmp_rem_nc_df</span><span class="op">$</span><span class="va">perc_in_neg</span>, digits <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">tmp_rem_nc</span><span class="op">$</span><span class="va">otu_table</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_1</span> <span class="op">&lt;-</span> <span class="va">tmp_1</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"ASV_ID"</span><span class="op">)</span></span>
<span><span class="va">tmp_1</span> <span class="op">&lt;-</span> <span class="va">tmp_1</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"total_samples"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>  </span>
<span></span>
<span><span class="va">tmp_2</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">tmp_rem_nc</span><span class="op">$</span><span class="va">otu_table</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"NNN"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_2</span><span class="op">$</span><span class="va">num_samp_nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">tmp_2</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">tmp_2</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">tmp_2</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"num_samp_nc"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_2</span> <span class="op">&lt;-</span> <span class="va">tmp_2</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"ASV_ID"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_3</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">tmp_rem_nc</span><span class="op">$</span><span class="va">otu_table</span>, <span class="op">-</span><span class="fu">contains</span><span class="op">(</span><span class="st">"NNN"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_3</span><span class="op">$</span><span class="va">num_samp_no_nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">tmp_3</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">tmp_3</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">tmp_3</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"num_samp_no_nc"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_3</span> <span class="op">&lt;-</span> <span class="va">tmp_3</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"ASV_ID"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_rem_nc_df</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">tmp_rem_nc_df</span>, <span class="va">tmp_1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                 <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">tmp_2</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>                 <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">tmp_3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_rem_nc_df</span> <span class="op">&lt;-</span> <span class="va">tmp_rem_nc_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>perc_in_neg_samp <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="op">(</span> <span class="va">num_samp_nc</span> <span class="op">/</span> <span class="op">(</span><span class="va">num_samp_nc</span> <span class="op">+</span> <span class="va">num_samp_no_nc</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                .after <span class="op">=</span> <span class="st">"num_samp_no_nc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nc_check</span> <span class="op">&lt;-</span> <span class="va">tmp_rem_nc_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="tbl-make-asv-in-nc-table-amf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-make-asv-in-nc-table-amf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Summary of ASVs detected in Negative Control (NC) samples.
</figcaption><div aria-describedby="tbl-make-asv-in-nc-table-amf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-189bf7e795965c842df7" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-189bf7e795965c842df7">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"ASV_ID":["ASV7","ASV17","ASV57","ASV265","ASV231","ASV304","ASV275","ASV550","ASV380","ASV300","ASV4","ASV633","ASV462","ASV12","ASV533","ASV98","ASV1","ASV880","ASV130","ASV71","ASV28","ASV347","ASV191","ASV51","ASV471","ASV110","ASV278","ASV631","ASV155","ASV21","ASV229","ASV501","ASV120","ASV2","ASV460","ASV646","ASV158","ASV145","ASV93","ASV276","ASV364","ASV638","ASV63","ASV212","ASV392","ASV474","ASV102","ASV173","ASV655","ASV23","ASV58"],"total_reads_NC":[1340,4,699,864,2,1,895,1,1,1,947,99,6,786,1,1,1252,1,1,1,1,12,1500,1939,6,1,867,1,1,1812,1,1,1,1269,1,4,1,3,2,1,2,1,14,17,418,1,126,103,6,3,1682],"total_reads_samps":[17703,11461,4079,85,1219,761,1,167,455,780,22571,2,285,12362,190,2898,39925,3,2200,3939,7705,547,0,3215,272,2557,2,102,1900,8024,1225,235,2342,28989,290,91,1832,2005,3034,893,502,98,4140,1353,0,273,2702,1563,83,9362,3038],"perc_in_neg":[7.036706,0.034889,14.629552,91.043203,0.1638,0.131234,99.888393,0.595238,0.219298,0.128041,4.026703,98.019802,2.061856,5.978096,0.52356,0.034495,3.040532,25,0.045434,0.025381,0.012977,2.146691,100,37.621265,2.158273,0.039093,99.76985,0.970874,0.052604,18.422123,0.081566,0.423729,0.04268,4.193932,0.343643,4.210526,0.054555,0.149402,0.065876,0.111857,0.396825,1.010101,0.337025,1.240876,100,0.364964,4.455446,6.182473,6.741573,0.032034,35.635593],"total_samples":[21,16,7,4,5,3,2,2,3,2,23,3,7,15,2,9,22,4,13,5,9,5,1,10,6,6,3,3,5,14,9,2,6,30,11,13,16,16,16,16,14,14,19,5,1,4,13,15,4,19,6],"num_samp_nc":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"num_samp_no_nc":[20,15,6,3,4,2,1,1,2,1,22,2,6,14,1,8,21,3,12,4,8,4,0,9,5,5,2,2,4,13,8,1,5,29,10,12,15,15,15,15,13,13,18,4,0,3,12,14,3,18,5],"perc_in_neg_samp":[4.76190476190476,6.25,14.2857142857143,25,20,33.3333333333333,50,50,33.3333333333333,50,4.34782608695652,33.3333333333333,14.2857142857143,6.66666666666667,50,11.1111111111111,4.54545454545455,25,7.69230769230769,20,11.1111111111111,20,100,10,16.6666666666667,16.6666666666667,33.3333333333333,33.3333333333333,20,7.14285714285714,11.1111111111111,50,16.6666666666667,3.33333333333333,9.09090909090909,7.69230769230769,6.25,6.25,6.25,6.25,7.14285714285714,7.14285714285714,5.26315789473684,20,100,25,7.69230769230769,6.66666666666667,25,5.26315789473684,16.6666666666667]},"columns":[{"id":"ASV_ID","name":"ASV ID","type":"character","sortable":true,"resizable":true,"filterable":false,"header":"ASV ID","align":"left","footerStyle":{"fontWeight":"bold"},"minWidth":100,"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"id":"total_reads_NC","name":"reads in NC","type":"numeric","sortable":true,"resizable":true,"filterable":false,"header":"reads in NC","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"total_reads_samps","name":"reads in non NC","type":"numeric","sortable":true,"resizable":true,"filterable":false,"header":"reads in non NC","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"perc_in_neg","name":"% in NC","type":"numeric","sortable":true,"resizable":true,"filterable":false,"header":"% in NC","align":"center","footerStyle":{"fontWeight":"bold"},"format":{"cell":{"digits":2},"aggregated":{"digits":2}}},{"id":"total_samples","name":"total samples","type":"numeric","sortable":true,"resizable":true,"filterable":false,"header":"total samples","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"num_samp_nc","name":"Total NC samples","type":"numeric","sortable":true,"resizable":true,"filterable":false,"header":"Total NC samples","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"num_samp_no_nc","name":"Total non-NC samples","type":"numeric","sortable":true,"resizable":true,"filterable":false,"header":"Total non-NC samples","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"perc_in_neg_samp","name":"% of samples","type":"numeric","sortable":true,"resizable":true,"filterable":false,"header":"% of samples","align":"center","footerStyle":{"fontWeight":"bold"},"format":{"cell":{"digits":2},"aggregated":{"digits":2}}}],"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,51],"highlight":true,"bordered":true,"striped":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"829c04323014af7d4617291d98eeddd8"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#asv_in_nc_samples" onclick="fetch('data:text/plain;base64,QVNWX0lECXRvdGFsX3JlYWRzX05DCXRvdGFsX3JlYWRzX3NhbXBzCXBlcmNfaW5fbmVnCXRvdGFsX3NhbXBsZXMJbnVtX3NhbXBfbmMJbnVtX3NhbXBfbm9fbmMJcGVyY19pbl9uZWdfc2FtcApBU1Y3CTEzNDAJMTc3MDMJNy4wMzY3MDYJMjEJMQkyMAk0Ljc2MTkwNDc2MTkwNDc2MgpBU1YxNwk0CTExNDYxCTAuMDM0ODg5CTE2CTEJMTUJNi4yNQpBU1Y1Nwk2OTkJNDA3OQkxNC42Mjk1NTIJNwkxCTYJMTQuMjg1NzE0Mjg1NzE0Mjg1CkFTVjI2NQk4NjQJODUJOTEuMDQzMjAzCTQJMQkzCTI1CkFTVjIzMQkyCTEyMTkJMC4xNjM4CTUJMQk0CTIwCkFTVjMwNAkxCTc2MQkwLjEzMTIzNAkzCTEJMgkzMy4zMzMzMzMzMzMzMzMzMwpBU1YyNzUJODk1CTEJOTkuODg4MzkzCTIJMQkxCTUwCkFTVjU1MAkxCTE2NwkwLjU5NTIzOAkyCTEJMQk1MApBU1YzODAJMQk0NTUJMC4yMTkyOTgJMwkxCTIJMzMuMzMzMzMzMzMzMzMzMzMKQVNWMzAwCTEJNzgwCTAuMTI4MDQxCTIJMQkxCTUwCkFTVjQJOTQ3CTIyNTcxCTQuMDI2NzAzCTIzCTEJMjIJNC4zNDc4MjYwODY5NTY1MjE1CkFTVjYzMwk5OQkyCTk4LjAxOTgwMgkzCTEJMgkzMy4zMzMzMzMzMzMzMzMzMwpBU1Y0NjIJNgkyODUJMi4wNjE4NTYJNwkxCTYJMTQuMjg1NzE0Mjg1NzE0Mjg1CkFTVjEyCTc4NgkxMjM2Mgk1Ljk3ODA5NgkxNQkxCTE0CTYuNjY2NjY2NjY2NjY2NjY3CkFTVjUzMwkxCTE5MAkwLjUyMzU2CTIJMQkxCTUwCkFTVjk4CTEJMjg5OAkwLjAzNDQ5NQk5CTEJOAkxMS4xMTExMTExMTExMTExMQpBU1YxCTEyNTIJMzk5MjUJMy4wNDA1MzIJMjIJMQkyMQk0LjU0NTQ1NDU0NTQ1NDU0NgpBU1Y4ODAJMQkzCTI1CTQJMQkzCTI1CkFTVjEzMAkxCTIyMDAJMC4wNDU0MzQJMTMJMQkxMgk3LjY5MjMwNzY5MjMwNzY5MjUKQVNWNzEJMQkzOTM5CTAuMDI1MzgxCTUJMQk0CTIwCkFTVjI4CTEJNzcwNQkwLjAxMjk3Nwk5CTEJOAkxMS4xMTExMTExMTExMTExMQpBU1YzNDcJMTIJNTQ3CTIuMTQ2NjkxCTUJMQk0CTIwCkFTVjE5MQkxNTAwCTAJMTAwCTEJMQkwCTEwMApBU1Y1MQkxOTM5CTMyMTUJMzcuNjIxMjY1CTEwCTEJOQkxMApBU1Y0NzEJNgkyNzIJMi4xNTgyNzMJNgkxCTUJMTYuNjY2NjY2NjY2NjY2NjY0CkFTVjExMAkxCTI1NTcJMC4wMzkwOTMJNgkxCTUJMTYuNjY2NjY2NjY2NjY2NjY0CkFTVjI3OAk4NjcJMgk5OS43Njk4NQkzCTEJMgkzMy4zMzMzMzMzMzMzMzMzMwpBU1Y2MzEJMQkxMDIJMC45NzA4NzQJMwkxCTIJMzMuMzMzMzMzMzMzMzMzMzMKQVNWMTU1CTEJMTkwMAkwLjA1MjYwNAk1CTEJNAkyMApBU1YyMQkxODEyCTgwMjQJMTguNDIyMTIzCTE0CTEJMTMJNy4xNDI4NTcxNDI4NTcxNDIKQVNWMjI5CTEJMTIyNQkwLjA4MTU2Ngk5CTEJOAkxMS4xMTExMTExMTExMTExMQpBU1Y1MDEJMQkyMzUJMC40MjM3MjkJMgkxCTEJNTAKQVNWMTIwCTEJMjM0MgkwLjA0MjY4CTYJMQk1CTE2LjY2NjY2NjY2NjY2NjY2NApBU1YyCTEyNjkJMjg5ODkJNC4xOTM5MzIJMzAJMQkyOQkzLjMzMzMzMzMzMzMzMzMzMzUKQVNWNDYwCTEJMjkwCTAuMzQzNjQzCTExCTEJMTAJOS4wOTA5MDkwOTA5MDkwOTIKQVNWNjQ2CTQJOTEJNC4yMTA1MjYJMTMJMQkxMgk3LjY5MjMwNzY5MjMwNzY5MjUKQVNWMTU4CTEJMTgzMgkwLjA1NDU1NQkxNgkxCTE1CTYuMjUKQVNWMTQ1CTMJMjAwNQkwLjE0OTQwMgkxNgkxCTE1CTYuMjUKQVNWOTMJMgkzMDM0CTAuMDY1ODc2CTE2CTEJMTUJNi4yNQpBU1YyNzYJMQk4OTMJMC4xMTE4NTcJMTYJMQkxNQk2LjI1CkFTVjM2NAkyCTUwMgkwLjM5NjgyNQkxNAkxCTEzCTcuMTQyODU3MTQyODU3MTQyCkFTVjYzOAkxCTk4CTEuMDEwMTAxCTE0CTEJMTMJNy4xNDI4NTcxNDI4NTcxNDIKQVNWNjMJMTQJNDE0MAkwLjMzNzAyNQkxOQkxCTE4CTUuMjYzMTU3ODk0NzM2ODQyCkFTVjIxMgkxNwkxMzUzCTEuMjQwODc2CTUJMQk0CTIwCkFTVjM5Mgk0MTgJMAkxMDAJMQkxCTAJMTAwCkFTVjQ3NAkxCTI3MwkwLjM2NDk2NAk0CTEJMwkyNQpBU1YxMDIJMTI2CTI3MDIJNC40NTU0NDYJMTMJMQkxMgk3LjY5MjMwNzY5MjMwNzY5MjUKQVNWMTczCTEwMwkxNTYzCTYuMTgyNDczCTE1CTEJMTQJNi42NjY2NjY2NjY2NjY2NjcKQVNWNjU1CTYJODMJNi43NDE1NzMJNAkxCTMJMjUKQVNWMjMJMwk5MzYyCTAuMDMyMDM0CTE5CTEJMTgJNS4yNjMxNTc4OTQ3MzY4NDIKQVNWNTgJMTY4MgkzMDM4CTM1LjYzNTU5Mwk2CTEJNQkxNi42NjY2NjY2NjY2NjY2NjQK').then(res => res.blob()).then(blob => {
      const downloadURL = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      document.body.appendChild(a);
      a.href = downloadURL;
      a.download = 'amf_asv_in_nc_samples.txt'; a.click();
      window.URL.revokeObjectURL(downloadURL);
      document.body.removeChild(a);
        });"><button class="btn btn-primary downloadthis  data-button" id="asv_in_nc_samples"><i class="bi bi-table"></i> Download ASVs in NC samples </button></a></p>
<p>Looking at these data we can see that some of the abundant ASVs like ASV1, ASV2, and ASV7 are found in the negative control sample but make up less than 10% of total reads. Other abundant ASVs like ASV21, ASV51, and ASV57 however are more abundant in the NC sample, comprising greater than 10% of total reads. We should remove any ASVs that are relatively abundant in the NC sample, specifically remove any ASVs where…</p>
<ol type="1">
<li>the number of reads found in NC samples accounted for more than 10% of total reads</li>
</ol>
<p>We can also consider the following criteria to further filtering out potential contamination.</p>
<ol start="2" type="1">
<li>the percent of NC samples containing the ASV was greater than 10% of total samples.</li>
</ol>
<p>However, since we only have 1 NC sample the second criteria does not make much sense. Consider ASV71–3940 total reads, 1 of which was found in the NC sample, or 0.025%. So that does not meet our first criteria. But ASV71 is only found in 5 samples (including the NC) which means that the percent of NC samples containing ASV71 is 20%, which meets our second criteria and should be removed. But I think we can safely retain ASV71 or any ASV that is only found in a few samples and low abundance in the NC sample.</p>
<p>So instead we will remove any ASVs that are represented by &gt;10% of total reads OR found in fewer than 10% of non-NC samples.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nc_remove</span> <span class="op">&lt;-</span> <span class="va">nc_check</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">perc_in_neg</span> <span class="op">&gt;</span> <span class="fl">10</span> <span class="op">|</span> <span class="va">num_samp_no_nc</span> <span class="op">&lt;</span> <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 21%">
<col style="width: 21%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Total ASVs</th>
<th>NC reads</th>
<th>non NC reads</th>
<th>% NC reads</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Removed</td>
<td>20</td>
<td>10790</td>
<td>21495</td>
<td>33.421</td>
</tr>
<tr class="even">
<td>Retained</td>
<td>31</td>
<td>5910</td>
<td>187965</td>
<td>3.048</td>
</tr>
</tbody>
</table>
<p>We identified a total of 51 ASVs that were present in at least 1 NC sample by at least 1 read. We removed any ASV where more than 10% of total reads were found in NC samples OR any ASV found in less than 10% of non-NC samples. Based on these criteria we removed 20 ASVs from the data set, which represented 10790 total reads in NC samples and 21495 total reads in non-NC samples. Of the total reads removed 33.421% came from NC samples. Of all ASVs identified in NC samples,31 were retained because the fell below the threshhold criteria. These ASVs accounted for 5910 reads in NC samples and 187965 reads in non-NC samples. NC samples accounted for 3.048% of these reads.</p>
<p>OK, now we can remove the NC samples and any ASVs that met our criteria described above.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_no_nc</span> <span class="op">&lt;-</span> <span class="fu">microeco</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microeco/man/clone.html">clone</a></span><span class="op">(</span><span class="va">tmp_no_na</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_rem_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">nc_remove</span><span class="op">$</span><span class="va">ASV_ID</span><span class="op">)</span></span>
<span><span class="va">tmp_no_nc</span><span class="op">$</span><span class="va">otu_table</span> <span class="op">&lt;-</span> <span class="va">tmp_rem_nc</span><span class="op">$</span><span class="va">otu_table</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">tmp_no_nc</span><span class="op">$</span><span class="va">otu_table</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">tmp_rem_asv</span><span class="op">)</span></span>
<span><span class="va">tmp_no_nc</span><span class="op">$</span><span class="fu">tidy_dataset</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_no_nc</span><span class="op">$</span><span class="va">sample_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">tmp_no_nc</span><span class="op">$</span><span class="va">sample_table</span>, </span>
<span>                                 <span class="va">Treatment</span> <span class="op">!=</span> <span class="st">"Negative"</span><span class="op">)</span></span>
<span><span class="va">tmp_no_nc</span><span class="op">$</span><span class="fu">tidy_dataset</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">me_asv_no_nc</span> <span class="op">&lt;-</span> <span class="fu">microeco</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microeco/man/clone.html">clone</a></span><span class="op">(</span><span class="va">tmp_no_nc</span><span class="op">)</span></span>
<span><span class="va">me_asv_no_nc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>microtable-class object:
sample_table have 40 rows and 19 columns
otu_table have 558 rows and 40 columns
tax_table have 558 rows and 7 columns
rep_fasta have 558 sequences</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>The microeco object <code>me_asv_no_nc</code> does not conatins the negative control sample(s).</p>
</blockquote>
</section><section id="remove-low-count-samples" class="level3"><h3 class="anchored" data-anchor-id="remove-low-count-samples">Remove Low-Count Samples</h3>
<p>Next, we can remove samples with really low read counts—here we set the threshold to <code>1000</code> reads.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_no_low</span> <span class="op">&lt;-</span> <span class="fu">microeco</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microeco/man/clone.html">clone</a></span><span class="op">(</span><span class="va">tmp_no_nc</span><span class="op">)</span></span>
<span><span class="va">tmp_no_low</span><span class="op">$</span><span class="va">otu_table</span> <span class="op">&lt;-</span> <span class="va">tmp_no_nc</span><span class="op">$</span><span class="va">otu_table</span> <span class="op">%&gt;%</span></span>
<span>          <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_no_low</span><span class="op">$</span><span class="fu">tidy_dataset</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check if any row sum (i.e., ASVs) is equal to 0 after removing the negative control sample(s).</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_row_sums</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">tmp_no_low</span><span class="op">$</span><span class="va">otu_table</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">tmp_row_sums</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>[1] FALSE</code></pre>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">me_asv_no_low</span> <span class="op">&lt;-</span> <span class="fu">microeco</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microeco/man/clone.html">clone</a></span><span class="op">(</span><span class="va">tmp_no_low</span><span class="op">)</span></span>
<span><span class="va">me_asv_no_low</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>microtable-class object:
sample_table have 39 rows and 19 columns
otu_table have 558 rows and 39 columns
tax_table have 558 rows and 7 columns
rep_fasta have 558 sequences</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>The microeco object <code>me_asv_no_low</code> does not conatins the low abundance samples.</p>
</blockquote>
<p>We will quickly add final read counts and ASVs, then create the final microtable object.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_final_rc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">me_asv_no_low</span><span class="op">$</span><span class="fu">sample_sums</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"SampleID"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"final_rc"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp_final_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">me_asv_no_low</span><span class="op">$</span><span class="va">otu_table</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tmp_final_asv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">tmp_final_asv</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="st">"SampleID"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"final_asv"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">tmp_final</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">tmp_final_rc</span>, <span class="va">tmp_final_asv</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_tab</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">full_join</a></span><span class="op">(</span><span class="va">sample_tab</span>, <span class="va">tmp_final</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">final_rc</span>, <span class="va">final_asv</span><span class="op">)</span>, .after <span class="op">=</span> <span class="va">lotus3_asv</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_tab</span> <span class="op">&lt;-</span> <span class="va">sample_tab</span> <span class="op">%&gt;%</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span><span class="st">"SampleID"</span><span class="op">)</span></span>
<span><span class="va">sample_tab</span><span class="op">$</span><span class="va">SampleID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sample_tab</span><span class="op">)</span></span>
<span><span class="va">sample_tab</span> <span class="op">&lt;-</span> <span class="va">sample_tab</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">SampleID</span><span class="op">)</span></span>
<span></span>
<span><span class="va">full_sample_tab</span> <span class="op">&lt;-</span> <span class="va">sample_tab</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp_samp_tab</span> <span class="op">&lt;-</span> <span class="va">sample_tab</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">sample_tab</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">tmp_tax_tab</span> <span class="op">&lt;-</span> <span class="va">me_asv_no_low</span><span class="op">$</span><span class="va">tax_table</span></span>
<span><span class="va">tmp_otu_tab</span> <span class="op">&lt;-</span> <span class="va">me_asv_no_low</span><span class="op">$</span><span class="va">otu_table</span></span>
<span><span class="va">tmp_rep_fasta</span> <span class="op">&lt;-</span> <span class="va">me_asv_no_low</span><span class="op">$</span><span class="va">rep_fasta</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">me_asv</span> <span class="op">&lt;-</span> <span class="va"><a href="https://rdrr.io/pkg/microeco/man/microtable.html">microtable</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>sample_table <span class="op">=</span> <span class="va">tmp_samp_tab</span>, </span>
<span>                         otu_table <span class="op">=</span> <span class="va">tmp_otu_tab</span>, </span>
<span>                         tax_table <span class="op">=</span> <span class="va">tmp_tax_tab</span>, </span>
<span>                         rep_fasta <span class="op">=</span> <span class="va">tmp_rep_fasta</span><span class="op">)</span></span>
<span><span class="va">me_asv</span><span class="op">$</span><span class="fu">tidy_dataset</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>microtable-class object:
sample_table have 39 rows and 21 columns
otu_table have 558 rows and 39 columns
tax_table have 558 rows and 7 columns
rep_fasta have 558 sequences</code></pre>
</div>
</div>
</section></section></section><section id="summary" class="level1"><h1>Summary</h1>
<p>Now time to summarize the data. For this we use the R package <a href="https://microbiome.github.io">miaverse</a> <span class="citation" data-cites="felix2024mia">(<a href="#ref-felix2024mia" role="doc-biblioref">Borman et al. 2024</a>)</span>.</p>
<p>Here we can see how the total number of ASVs, reads, and samples changed during the curation process.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">me_dataset</th>
<th style="text-align: right;">total_asvs</th>
<th style="text-align: right;">total_reads</th>
<th style="text-align: right;">total_samples</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">original</td>
<td style="text-align: right;">883</td>
<td style="text-align: right;">1167700</td>
<td style="text-align: right;">41</td>
</tr>
<tr class="even">
<td style="text-align: left;">No NA kingdom</td>
<td style="text-align: right;">578</td>
<td style="text-align: right;">879088</td>
<td style="text-align: right;">41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">no neg control</td>
<td style="text-align: right;">558</td>
<td style="text-align: right;">840893</td>
<td style="text-align: right;">40</td>
</tr>
<tr class="even">
<td style="text-align: left;">no low count samps</td>
<td style="text-align: right;">558</td>
<td style="text-align: right;">840714</td>
<td style="text-align: right;">39</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>And some additional metrics describing the changes.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 41%">
<col style="width: 37%">
</colgroup>
<thead><tr class="header">
<th>Metric</th>
<th>Start</th>
<th>End</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Min. number reads</td>
<td>221</td>
<td>3420</td>
</tr>
<tr class="even">
<td>Max. number reads</td>
<td>52244</td>
<td>42816</td>
</tr>
<tr class="odd">
<td>Total number reads</td>
<td>1167700</td>
<td>840714</td>
</tr>
<tr class="even">
<td>Avg number reads</td>
<td>28480</td>
<td>21557</td>
</tr>
<tr class="odd">
<td>Median no. reads</td>
<td>31733</td>
<td>22231</td>
</tr>
<tr class="even">
<td>Total ASVs</td>
<td>883</td>
<td>558</td>
</tr>
<tr class="odd">
<td>No.&nbsp;singleton ASVs</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>Avg ASVs per sample.</td>
<td>85</td>
<td>56</td>
</tr>
</tbody>
</table>
<p>We started off with 883 ASVs and 41 samples. Screening for <code>NA</code> and non-fungal kingdom assignment removed an additional 305 ASVs. After removing the negative controls there were 558 ASVs and 40. After removing low-count samples, there were 558 ASVs and 39 samples remaining.</p>
<div class="cell">
<div id="tbl-make-final-rc-asv-table-amf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-make-final-rc-asv-table-amf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Beginning and ending read counts &amp; total ASVs by sample.
</figcaption><div aria-describedby="tbl-make-final-rc-asv-table-amf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-4e280cda47fb19178af4" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4e280cda47fb19178af4">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"SampleID":["P00_D00_000_NNN","P01_D00_010_W4A","P01_D10_020_W4A","P01_D20_050_W4A","P01_D50_100_W4A","P02_D00_010_C0A","P02_D10_020_C0A","P02_D20_050_C0A","P02_D50_100_C0A","P03_D00_010_W4B","P03_D10_020_W4B","P03_D20_050_W4B","P03_D50_100_W4B","P04_D00_010_C0B","P04_D10_020_C0B","P04_D20_050_C0B","P04_D50_100_C0B","P05_D00_010_W4C","P05_D10_020_W4C","P05_D20_050_W4C","P05_D50_100_W4C","P06_D00_010_C0C","P06_D10_020_C0C","P06_D20_050_C0C","P06_D50_100_C0C","P07_D00_010_W4D","P07_D10_020_W4D","P07_D20_050_W4D","P07_D50_100_W4D","P08_D00_010_C0D","P08_D10_020_C0D","P08_D20_050_C0D","P08_D50_100_C0D","P09_D00_010_W4E","P09_D10_020_W4E","P09_D20_050_W4E","P09_D50_100_W4E","P10_D00_010_C0E","P10_D10_020_C0E","P10_D20_050_C0E","P10_D50_100_C0E"],"start_rc":[23941,37078,19128,221,5691,20077,15942,52244,25653,39935,37830,31733,32641,39828,32152,32667,27786,37990,30352,18483,10192,39810,39087,40591,14165,35343,39748,27651,28039,33275,35481,28657,27881,33264,36805,23364,3442,35538,35204,22433,16358],"start_asv":[63,213,53,13,49,168,63,97,31,144,82,39,53,230,61,158,56,86,79,25,20,200,106,115,23,77,209,41,31,63,63,40,30,165,72,40,21,292,74,24,23],"final_rc":["NA",22133,16267,"NA",4573,18400,7671,42816,24728,28818,28396,31730,25705,21570,26650,23244,23989,28728,26501,12743,10189,25866,25365,27869,11420,18410,24543,22825,21976,31217,22129,22231,14944,21406,30122,13587,3420,17774,27265,19668,13826],"final_asv":["NA",97,37,"NA",34,105,30,76,29,88,59,36,38,128,49,115,45,66,65,17,17,110,65,78,16,43,130,31,26,49,41,32,15,85,45,26,17,153,54,16,14]},"columns":[{"id":"SampleID","name":"SampleID","type":"character","sortable":true,"resizable":true,"filterable":false,"cell":["P00_D00_000_NNN","P01_D00_010_W4A","P01_D10_020_W4A","P01_D20_050_W4A","P01_D50_100_W4A","P02_D00_010_C0A","P02_D10_020_C0A","P02_D20_050_C0A","P02_D50_100_C0A","P03_D00_010_W4B","P03_D10_020_W4B","P03_D20_050_W4B","P03_D50_100_W4B","P04_D00_010_C0B","P04_D10_020_C0B","P04_D20_050_C0B","P04_D50_100_C0B","P05_D00_010_W4C","P05_D10_020_W4C","P05_D20_050_W4C","P05_D50_100_W4C","P06_D00_010_C0C","P06_D10_020_C0C","P06_D20_050_C0C","P06_D50_100_C0C","P07_D00_010_W4D","P07_D10_020_W4D","P07_D20_050_W4D","P07_D50_100_W4D","P08_D00_010_C0D","P08_D10_020_C0D","P08_D20_050_C0D","P08_D50_100_C0D","P09_D00_010_W4E","P09_D10_020_W4E","P09_D20_050_W4E","P09_D50_100_W4E","P10_D00_010_C0E","P10_D10_020_C0E","P10_D20_050_C0E","P10_D50_100_C0E"],"header":"SampleID","align":"left","footerStyle":{"fontWeight":"bold"},"minWidth":150,"sticky":"left","style":{"borderRight":"1px solid #eee"},"headerStyle":{"borderRight":"1px solid #eee"}},{"id":"start_rc","name":"start rc","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["23941","37078","19128","221","5691","20077","15942","52244","25653","39935","37830","31733","32641","39828","32152","32667","27786","37990","30352","18483","10192","39810","39087","40591","14165","35343","39748","27651","28039","33275","35481","28657","27881","33264","36805","23364","3442","35538","35204","22433","16358"],"header":"start rc","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"start_asv","name":"start asv","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["63","213","53","13","49","168","63","97","31","144","82","39","53","230","61","158","56","86","79","25","20","200","106","115","23","77","209","41","31","63","63","40","30","165","72","40","21","292","74","24","23"],"header":"start asv","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"final_rc","name":"final rc","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["NA","22133","16267","NA","4573","18400","7671","42816","24728","28818","28396","31730","25705","21570","26650","23244","23989","28728","26501","12743","10189","25866","25365","27869","11420","18410","24543","22825","21976","31217","22129","22231","14944","21406","30122","13587","3420","17774","27265","19668","13826"],"header":"final rc","align":"center","footerStyle":{"fontWeight":"bold"}},{"id":"final_asv","name":"final asv","type":"numeric","sortable":true,"resizable":true,"filterable":false,"cell":["NA","97","37","NA","34","105","30","76","29","88","59","36","38","128","49","115","45","66","65","17","17","110","65","78","16","43","130","31","26","49","41","32","15","85","45","26","17","153","54","16","14"],"header":"final asv","align":"center","footerStyle":{"fontWeight":"bold"}}],"defaultPageSize":5,"showPageSizeOptions":true,"pageSizeOptions":[5,10,41],"highlight":true,"bordered":true,"striped":true,"nowrap":true,"showSortable":true,"theme":{"style":{"fontSize":"0.8em"}},"dataKey":"7d273823eef262ce6ca69bc96bea3cfe"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</figure>
</div>
</div>
<p></p>
<p>We lost 2 samples after curating the dataset.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "P00_D00_000_NNN" "P01_D20_050_W4A"</code></pre>
</div>
</div>
</section><section class="level1"><h1>Links</h1>
<ul>
<li><a href="https://chiliubio.github.io/microeco_tutorial/">microeco</a></li>
<li><a href="https://chiliubio.github.io/microeco_tutorial/basic-class.html#prepare-the-example-data">microeco</a></li>
<li><a href="https://chiliubio.github.io/microeco_tutorial/basic-class.html">microtable object</a></li>
<li><a href="https://microbiome.github.io">miaverse</a></li>
<li><a href="https://github.com/sweltr/depth/blob/main/curate_amf.qmd">curate_amf.qmd</a></li>
<li><a href="https://doi.org/10.25573/data.16828063">10.25573/data.16828063</a></li>
<li><a href="https://metacrobe.github.io/">metacrobe</a></li>
<li><a href="https://quarto.org/">Quarto</a></li>
</ul></section><div id="quarto-appendix" class="default"><section id="source-code" class="level4 appendix"><h2 class="anchored quarto-appendix-heading">Source Code</h2><div class="quarto-appendix-contents">
<p>The source code for this page can be found on GitHub <svg aria-hidden="true" role="img" viewbox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> by visiting the <a href="https://github.com/sweltr/depth/blob/main/curate_amf.qmd">curate_amf.qmd</a> page.</p>
</div></section><section id="data-availability" class="level4 appendix"><h2 class="anchored quarto-appendix-heading">Data Availability</h2><div class="quarto-appendix-contents">
<p>Data generated in this workflow and the Rdata need to run the workflow can be accessed on figshare at <a href="https://doi.org/10.25573/data.16828063">10.25573/data.16828063</a>.</p>
</div></section><section id="last-updated-on" class="level4 appendix"><h2 class="anchored quarto-appendix-heading">Last updated on</h2><div class="quarto-appendix-contents">
<p>2025-08-29 07:48:13.814209</p>


<!-- -->

</div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/sweltr\.github\.io\/depth\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./curate_its.html" class="pagination-link" aria-label="3b. ITS Data Curation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">3b. ITS Data Curation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./curate_oo.html" class="pagination-link" aria-label="3d. Oomycete Data Curation">
        <span class="nav-page-text">3d. Oomycete Data Curation</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb59" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "3c. AMF Data Curation"</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Workflow for curating the ASV dataset--generating microeco &amp; phyloseq objects, removing spurious ASVs and low-count/negative control samples. "</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co">    other-links: </span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co">      - text: Data</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co">        href: https://doi.org/10.25573/data.16828063</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>{{&lt; include include/code/_setup.qmd &gt;}}</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>{{&lt; include include/code/_curate.qmd &gt;}}</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="fu"># Overview</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>On this page we use the phyloseq output from LotuS3 to format the otu, taxonomy, and sample data tables so we can create a microeco object. Once that is complete we curate the dataset by removing possible contaminants, negative control samples, NA kingdoms, and low-count samples.  </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data </span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>All you need to run this workflow is the phyloseq object generated by the LotuS3 pipeline.</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="default" icon=false}</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="fu">### {{&lt; fa download &gt;}} &amp;nbsp; phyloseq_amf.Rdata</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>{{&lt; downloadthis files/CURATE/phyloseq_amf.Rdata dname="phyloseq_amf" label="LotuS3 phyloseq data" icon="database" type="link" &gt;}}</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a><span class="fu">## Citable resources </span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Packages used in this workflow:</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>R microeco package <span class="co">[</span><span class="ot">@liu2021microeco</span><span class="co">]</span>. </span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>phyloseq R package <span class="co">[</span><span class="ot">@mcmurdie2013phyloseq</span><span class="co">]</span>.</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>miaverse <span class="co">[</span><span class="ot">@felix2024mia</span><span class="co">]</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>library(microeco)</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>library(microbiome)</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a><span class="fu"># Workflow</span></span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## Required Packages</span></span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Click here for required R packages."</span></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">919191</span>)</span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microeco)</span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mia)</span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phyloseq)</span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbiome)</span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(list = ls())</span></span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"page_build/amf_curate.rdata"</span>)</span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true" tabindex="-1"></a><span class="fu">## Review Results</span></span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true" tabindex="-1"></a>The LotuS3 pipeline produces numerous output files  but for our purposes there are four specific files we are interested in:</span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-83"><a href="#cb59-83" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`phyloseq.Rdata`</span></span>
<span id="cb59-84"><a href="#cb59-84" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span><span class="in">`OTU.fna`</span></span>
<span id="cb59-85"><a href="#cb59-85" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span><span class="in">`OTU.txt`</span></span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span><span class="in">`hiera_BLAST.txt`</span></span>
<span id="cb59-87"><a href="#cb59-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-88"><a href="#cb59-88" aria-hidden="true" tabindex="-1"></a>We will mainly work from the <span class="in">`phyloseq.Rdata`</span> (renamed <span class="in">`phyloseq_amf.Rdata`</span>) since this contains the OTU Table, Sample Data, Taxonomy Table, and Phylogenetic Tree. Note: a phylogenetic tree of microbial ASVs from short reads seems less than useful. Therefore, we will exclude this from the initial analysis. </span>
<span id="cb59-89"><a href="#cb59-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-92"><a href="#cb59-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-93"><a href="#cb59-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-94"><a href="#cb59-94" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-95"><a href="#cb59-95" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"working_files/LOTUS3/amf/phyloseq_amf.Rdata"</span>)</span>
<span id="cb59-96"><a href="#cb59-96" aria-hidden="true" tabindex="-1"></a>physeq</span>
<span id="cb59-97"><a href="#cb59-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-98"><a href="#cb59-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-99"><a href="#cb59-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-100"><a href="#cb59-100" aria-hidden="true" tabindex="-1"></a><span class="in">phyloseq-class experiment-level object</span></span>
<span id="cb59-101"><a href="#cb59-101" aria-hidden="true" tabindex="-1"></a><span class="in">otu_table()   OTU Table:          [ 883 taxa and 41 samples ]:</span></span>
<span id="cb59-102"><a href="#cb59-102" aria-hidden="true" tabindex="-1"></a><span class="in">sample_data() Sample Data:        [ 41 samples by 14 sample variables ]:</span></span>
<span id="cb59-103"><a href="#cb59-103" aria-hidden="true" tabindex="-1"></a><span class="in">tax_table()   Taxonomy Table:     [ 883 taxa by 7 taxonomic ranks ]:</span></span>
<span id="cb59-104"><a href="#cb59-104" aria-hidden="true" tabindex="-1"></a><span class="in">phy_tree()    Phylogenetic Tree:  [ 883 tips and 881 internal nodes ]:</span></span>
<span id="cb59-105"><a href="#cb59-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-106"><a href="#cb59-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-109"><a href="#cb59-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb59-110"><a href="#cb59-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-111"><a href="#cb59-111" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-112"><a href="#cb59-112" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> working_files/LOTUS3/amf/phyloseq_amf.Rdata files/CURATE</span>
<span id="cb59-113"><a href="#cb59-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-114"><a href="#cb59-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-115"><a href="#cb59-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-118"><a href="#cb59-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-119"><a href="#cb59-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-120"><a href="#cb59-120" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-121"><a href="#cb59-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: this is for fixing two column names in the sample_data rather than rerunning the pipeline. </span></span>
<span id="cb59-122"><a href="#cb59-122" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(speedyseq)</span>
<span id="cb59-123"><a href="#cb59-123" aria-hidden="true" tabindex="-1"></a>physeq <span class="ot">&lt;-</span> physeq <span class="sc">%&gt;%</span> </span>
<span id="cb59-124"><a href="#cb59-124" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename_sample_data</span>(<span class="at">I7_Index =</span> index) <span class="sc">%&gt;%</span></span>
<span id="cb59-125"><a href="#cb59-125" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename_sample_data</span>(<span class="at">I5_Index =</span> index2) </span>
<span id="cb59-126"><a href="#cb59-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-127"><a href="#cb59-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-130"><a href="#cb59-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-131"><a href="#cb59-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-132"><a href="#cb59-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-133"><a href="#cb59-133" aria-hidden="true" tabindex="-1"></a>min_read_ps <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">readcount</span>(physeq))</span>
<span id="cb59-134"><a href="#cb59-134" aria-hidden="true" tabindex="-1"></a>max_read_ps <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">readcount</span>(physeq))</span>
<span id="cb59-135"><a href="#cb59-135" aria-hidden="true" tabindex="-1"></a>total_reads_ps <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">readcount</span>(physeq))</span>
<span id="cb59-136"><a href="#cb59-136" aria-hidden="true" tabindex="-1"></a>mean_reads_ps <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">readcount</span>(physeq)), <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb59-137"><a href="#cb59-137" aria-hidden="true" tabindex="-1"></a>median_reads_ps <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">readcount</span>(physeq))</span>
<span id="cb59-138"><a href="#cb59-138" aria-hidden="true" tabindex="-1"></a>total_asvs_ps <span class="ot">&lt;-</span> <span class="fu">ntaxa</span>(physeq)</span>
<span id="cb59-139"><a href="#cb59-139" aria-hidden="true" tabindex="-1"></a>singleton_ps <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(<span class="fu">ntaxa</span>(<span class="fu">rare</span>(physeq, <span class="at">detection =</span> <span class="dv">1</span>, </span>
<span id="cb59-140"><a href="#cb59-140" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">prevalence =</span> <span class="dv">0</span>)), </span>
<span id="cb59-141"><a href="#cb59-141" aria-hidden="true" tabindex="-1"></a>                         <span class="at">error=</span><span class="cf">function</span>(err) <span class="cn">NA</span>)</span>
<span id="cb59-142"><a href="#cb59-142" aria-hidden="true" tabindex="-1"></a>singleton_ps_perc <span class="ot">&lt;-</span> </span>
<span id="cb59-143"><a href="#cb59-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>(<span class="fu">round</span>((<span class="dv">100</span><span class="sc">*</span>(<span class="fu">ntaxa</span>(<span class="fu">rare</span>(physeq, <span class="at">detection =</span> <span class="dv">1</span>, <span class="at">prevalence =</span> <span class="dv">0</span>)) <span class="sc">/</span></span>
<span id="cb59-144"><a href="#cb59-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ntaxa</span>(physeq))), <span class="at">digits =</span> <span class="dv">3</span>), <span class="at">error=</span><span class="cf">function</span>(err) <span class="cn">NA</span>)</span>
<span id="cb59-145"><a href="#cb59-145" aria-hidden="true" tabindex="-1"></a>sparsity_ps <span class="ot">&lt;-</span> </span>
<span id="cb59-146"><a href="#cb59-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">abundances</span>(physeq) <span class="sc">==</span> <span class="dv">0</span>))<span class="sc">/</span></span>
<span id="cb59-147"><a href="#cb59-147" aria-hidden="true" tabindex="-1"></a>          <span class="fu">length</span>(<span class="fu">abundances</span>(physeq)), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb59-148"><a href="#cb59-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-149"><a href="#cb59-149" aria-hidden="true" tabindex="-1"></a>ds_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rbind</span>(min_read_ps, max_read_ps, total_reads_ps, </span>
<span id="cb59-150"><a href="#cb59-150" aria-hidden="true" tabindex="-1"></a>                               mean_reads_ps, median_reads_ps, total_asvs_ps, </span>
<span id="cb59-151"><a href="#cb59-151" aria-hidden="true" tabindex="-1"></a>                               singleton_ps, singleton_ps_perc, sparsity_ps))</span>
<span id="cb59-152"><a href="#cb59-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-153"><a href="#cb59-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-154"><a href="#cb59-154" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Metric                              <span class="pp">|</span> Results                             <span class="pp">|</span></span>
<span id="cb59-155"><a href="#cb59-155" aria-hidden="true" tabindex="-1"></a><span class="pp">|-------------------------------------|-------------------------------------|</span></span>
<span id="cb59-156"><a href="#cb59-156" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Min. number of reads                <span class="pp">|</span> <span class="in">`r ds_metrics[1, ]`</span>                 <span class="pp">|</span></span>
<span id="cb59-157"><a href="#cb59-157" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Max. number of reads                <span class="pp">|</span> <span class="in">`r ds_metrics[2, ]`</span>                 <span class="pp">|</span></span>
<span id="cb59-158"><a href="#cb59-158" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Total number of reads               <span class="pp">|</span> <span class="in">`r ds_metrics[3, ]`</span>                 <span class="pp">|</span></span>
<span id="cb59-159"><a href="#cb59-159" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Average number of reads             <span class="pp">|</span> <span class="in">`r ds_metrics[4, ]`</span>                 <span class="pp">|</span></span>
<span id="cb59-160"><a href="#cb59-160" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Median number of reads              <span class="pp">|</span> <span class="in">`r ds_metrics[5, ]`</span>                 <span class="pp">|</span></span>
<span id="cb59-161"><a href="#cb59-161" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Total ASVs                          <span class="pp">|</span> <span class="in">`r ds_metrics[6, ]`</span>                 <span class="pp">|</span></span>
<span id="cb59-162"><a href="#cb59-162" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Number of singleton ASVs            <span class="pp">|</span> <span class="in">`r ds_metrics[7, ]`</span>                 <span class="pp">|</span></span>
<span id="cb59-163"><a href="#cb59-163" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Any ASVs sum to 1 or less?          <span class="pp">|</span> <span class="in">`r isTRUE(ds_metrics[7, ] &gt;= 1)`</span>    <span class="pp">|</span></span>
<span id="cb59-164"><a href="#cb59-164" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Percent of ASVs that are singletons <span class="pp">|</span> <span class="in">`r ds_metrics[8, ]`</span>                 <span class="pp">|</span></span>
<span id="cb59-165"><a href="#cb59-165" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Sparsity                            <span class="pp">|</span> <span class="in">`r ds_metrics[9, ]`</span>                 <span class="pp">|</span></span>
<span id="cb59-166"><a href="#cb59-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-167"><a href="#cb59-167" aria-hidden="true" tabindex="-1"></a>In this next part of the workflow the goal is to create a *microtable object* using the R package <span class="co">[</span><span class="ot">microeco</span><span class="co">](https://chiliubio.github.io/microeco_tutorial/)</span> <span class="co">[</span><span class="ot">@liu2021microeco</span><span class="co">]</span>. The microtable will be used to store the ASV by sample data as well the taxonomic, fasta, and sample data in a single object. More on that in a moment.</span>
<span id="cb59-168"><a href="#cb59-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-169"><a href="#cb59-169" aria-hidden="true" tabindex="-1"></a>We will also:</span>
<span id="cb59-170"><a href="#cb59-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-171"><a href="#cb59-171" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Remove any ASVs without kingdom level classification.\</span>
<span id="cb59-172"><a href="#cb59-172" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Revome any contaminants (chloroplast, mitochondria, etc.).\</span>
<span id="cb59-173"><a href="#cb59-173" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Remove Negative Control (NC) samples.\</span>
<span id="cb59-174"><a href="#cb59-174" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Remove any low-count samples.</span>
<span id="cb59-175"><a href="#cb59-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-176"><a href="#cb59-176" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Data</span></span>
<span id="cb59-177"><a href="#cb59-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-178"><a href="#cb59-178" aria-hidden="true" tabindex="-1"></a>Before we begin, let's create a summary table containing some basic sample metadata and the read count data. We want to inspect how total reads changed through the workflow. Table headers are as follows:</span>
<span id="cb59-179"><a href="#cb59-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-180"><a href="#cb59-180" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Header         <span class="pp">|</span> Description                                             <span class="pp">|</span></span>
<span id="cb59-181"><a href="#cb59-181" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------------|---------------------------------------------------------|</span></span>
<span id="cb59-182"><a href="#cb59-182" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`SampleID`</span>     <span class="pp">|</span> New sample ID based on plot, depth, treatment, &amp; pair   <span class="pp">|</span></span>
<span id="cb59-183"><a href="#cb59-183" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Plot`</span>         <span class="pp">|</span> Experimental plot ID                                    <span class="pp">|</span></span>
<span id="cb59-184"><a href="#cb59-184" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Treatment`</span>    <span class="pp">|</span> Control vs warming                                      <span class="pp">|</span></span>
<span id="cb59-185"><a href="#cb59-185" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Temp`</span>         <span class="pp">|</span> Warming treatment temperature                           <span class="pp">|</span></span>
<span id="cb59-186"><a href="#cb59-186" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Depth`</span>        <span class="pp">|</span> Sampling depth in soil                                  <span class="pp">|</span></span>
<span id="cb59-187"><a href="#cb59-187" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Pairing`</span>      <span class="pp">|</span> Sample pairings                                         <span class="pp">|</span></span>
<span id="cb59-188"><a href="#cb59-188" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`raw_rc`</span>       <span class="pp">|</span> No. of raw reads                                        <span class="pp">|</span></span>
<span id="cb59-189"><a href="#cb59-189" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`cutadapt_rc`</span>  <span class="pp">|</span> Read count after cutdapt                                <span class="pp">|</span></span>
<span id="cb59-190"><a href="#cb59-190" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`lotus3_rc`</span>    <span class="pp">|</span> Read count after LotuS3 pipeline                        <span class="pp">|</span></span>
<span id="cb59-191"><a href="#cb59-191" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`lotus3_asv`</span>   <span class="pp">|</span> No. of ASVs                                             <span class="pp">|</span></span>
<span id="cb59-192"><a href="#cb59-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-193"><a href="#cb59-193" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">br</span><span class="dt">/&gt;</span></span>
<span id="cb59-194"><a href="#cb59-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-195"><a href="#cb59-195" aria-hidden="true" tabindex="-1"></a>Now I do some wrangling of the sample data to format it for downstream analysis. WAhat I want to do is first add read counts from different point in the workflow. </span>
<span id="cb59-196"><a href="#cb59-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-199"><a href="#cb59-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-200"><a href="#cb59-200" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-201"><a href="#cb59-201" aria-hidden="true" tabindex="-1"></a>tmp_otu <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">otu_table</span>(physeq))</span>
<span id="cb59-202"><a href="#cb59-202" aria-hidden="true" tabindex="-1"></a>tmp_otu_sum <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">colSums</span>(tmp_otu <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-203"><a href="#cb59-203" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SampleID"</span>)</span>
<span id="cb59-204"><a href="#cb59-204" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tmp_otu_sum)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"lotus3_asv"</span></span>
<span id="cb59-205"><a href="#cb59-205" aria-hidden="true" tabindex="-1"></a>tmp_read_sum <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">colSums</span>(tmp_otu)) <span class="sc">%&gt;%</span></span>
<span id="cb59-206"><a href="#cb59-206" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SampleID"</span>)</span>
<span id="cb59-207"><a href="#cb59-207" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tmp_read_sum)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"lotus3_rc"</span></span>
<span id="cb59-208"><a href="#cb59-208" aria-hidden="true" tabindex="-1"></a>tmp_track_reads <span class="ot">&lt;-</span> <span class="fu">read.table</span>(</span>
<span id="cb59-209"><a href="#cb59-209" aria-hidden="true" tabindex="-1"></a>    <span class="st">"files/CUTADAPT/amf_cutadapt_track.txt"</span>,</span>
<span id="cb59-210"><a href="#cb59-210" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span></span>
<span id="cb59-211"><a href="#cb59-211" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-212"><a href="#cb59-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-213"><a href="#cb59-213" aria-hidden="true" tabindex="-1"></a>tmp_track_reads<span class="sc">$</span>SampleID <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(</span>
<span id="cb59-214"><a href="#cb59-214" aria-hidden="true" tabindex="-1"></a>  tmp_track_reads<span class="sc">$</span>SampleID, <span class="st">"-"</span>, <span class="st">"_"</span>)</span>
<span id="cb59-215"><a href="#cb59-215" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tmp_track_reads)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"raw_rc"</span></span>
<span id="cb59-216"><a href="#cb59-216" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(tmp_track_reads)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"cutadapt_rc"</span></span>
<span id="cb59-217"><a href="#cb59-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-218"><a href="#cb59-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-219"><a href="#cb59-219" aria-hidden="true" tabindex="-1"></a>Then I want to merge this data with the sample metadata. </span>
<span id="cb59-220"><a href="#cb59-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-223"><a href="#cb59-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-224"><a href="#cb59-224" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-225"><a href="#cb59-225" aria-hidden="true" tabindex="-1"></a>tmp_samp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">sample_data</span>(physeq)) <span class="sc">%&gt;%</span> </span>
<span id="cb59-226"><a href="#cb59-226" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SampleID"</span>)</span>
<span id="cb59-227"><a href="#cb59-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-228"><a href="#cb59-228" aria-hidden="true" tabindex="-1"></a>sample_tab <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_samp, tmp_track_reads, <span class="at">by =</span> <span class="st">"SampleID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-229"><a href="#cb59-229" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_read_sum, <span class="at">by =</span> <span class="st">"SampleID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-230"><a href="#cb59-230" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_otu_sum, <span class="at">by =</span> <span class="st">"SampleID"</span>) </span>
<span id="cb59-231"><a href="#cb59-231" aria-hidden="true" tabindex="-1"></a>sample_tab <span class="ot">&lt;-</span> sample_tab <span class="sc">%&gt;%</span></span>
<span id="cb59-232"><a href="#cb59-232" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, </span>
<span id="cb59-233"><a href="#cb59-233" aria-hidden="true" tabindex="-1"></a>                <span class="dv">19</span>, <span class="dv">9</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">2</span>)</span>
<span id="cb59-234"><a href="#cb59-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-235"><a href="#cb59-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-238"><a href="#cb59-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-239"><a href="#cb59-239" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_delim</span>(sample_tab, <span class="st">"files/CURATE/amf_sample_data_full.txt"</span>,</span>
<span id="cb59-240"><a href="#cb59-240" aria-hidden="true" tabindex="-1"></a>    <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb59-241"><a href="#cb59-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-242"><a href="#cb59-242" aria-hidden="true" tabindex="-1"></a>sample_tab_trim <span class="ot">&lt;-</span> sample_tab[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">19</span>)]</span>
<span id="cb59-243"><a href="#cb59-243" aria-hidden="true" tabindex="-1"></a>sample_tab_trim<span class="sc">$</span>per_reads_kept <span class="ot">&lt;-</span> </span>
<span id="cb59-244"><a href="#cb59-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(sample_tab_trim<span class="sc">$</span>lotus3_rc<span class="sc">/</span>sample_tab_trim<span class="sc">$</span>raw_rc, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb59-245"><a href="#cb59-245" aria-hidden="true" tabindex="-1"></a>sample_tab_trim <span class="ot">&lt;-</span> sample_tab_trim <span class="sc">%&gt;%</span> </span>
<span id="cb59-246"><a href="#cb59-246" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(per_reads_kept, <span class="at">.before =</span> lotus3_asv)</span>
<span id="cb59-247"><a href="#cb59-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-248"><a href="#cb59-248" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb59-249"><a href="#cb59-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-252"><a href="#cb59-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-253"><a href="#cb59-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-254"><a href="#cb59-254" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-255"><a href="#cb59-255" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-make-metadata-table-amf</span></span>
<span id="cb59-256"><a href="#cb59-256" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Sample metadata including read changes at start and end of workflow."</span></span>
<span id="cb59-257"><a href="#cb59-257" aria-hidden="true" tabindex="-1"></a><span class="fu">make_metadata_table</span>(sample_tab_trim)</span>
<span id="cb59-258"><a href="#cb59-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-259"><a href="#cb59-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-262"><a href="#cb59-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-263"><a href="#cb59-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-264"><a href="#cb59-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-265"><a href="#cb59-265" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_delim</span>(sample_tab_trim, <span class="st">"files/CURATE/amf_sample_data_with_rc.txt"</span>,</span>
<span id="cb59-266"><a href="#cb59-266" aria-hidden="true" tabindex="-1"></a>    <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb59-267"><a href="#cb59-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-268"><a href="#cb59-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-269"><a href="#cb59-269" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb59-270"><a href="#cb59-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-271"><a href="#cb59-271" aria-hidden="true" tabindex="-1"></a>{{&lt; downloadthis files/CURATE/amf_sample_data_with_rc.txt dname=amf_sample_data_with_rc label="Download sample metadata" icon=table type=primary class=data-button id=shrimp_md &gt;}}</span>
<span id="cb59-272"><a href="#cb59-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-273"><a href="#cb59-273" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prep Data for microeco</span></span>
<span id="cb59-274"><a href="#cb59-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-275"><a href="#cb59-275" aria-hidden="true" tabindex="-1"></a>Like any tool, the microeco package needs the data in a specific form. I formatted our data to match the mock data in this section,  <span class="co">[</span><span class="ot">microeco</span><span class="co">](https://chiliubio.github.io/microeco_tutorial/basic-class.html#prepare-the-example-data)</span> tutorial.</span>
<span id="cb59-276"><a href="#cb59-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-277"><a href="#cb59-277" aria-hidden="true" tabindex="-1"></a><span class="fu">### A. Taxonomy Table</span></span>
<span id="cb59-278"><a href="#cb59-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-279"><a href="#cb59-279" aria-hidden="true" tabindex="-1"></a>Here is what the taxonomy table looks like in the dataset.</span>
<span id="cb59-280"><a href="#cb59-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-283"><a href="#cb59-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-284"><a href="#cb59-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-285"><a href="#cb59-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-286"><a href="#cb59-286" aria-hidden="true" tabindex="-1"></a>tmp_tax <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">tax_table</span>(physeq))</span>
<span id="cb59-287"><a href="#cb59-287" aria-hidden="true" tabindex="-1"></a>tmp_tax[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb59-288"><a href="#cb59-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-289"><a href="#cb59-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-290"><a href="#cb59-290" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb59-291"><a href="#cb59-291" aria-hidden="true" tabindex="-1"></a><span class="in">       Domain    Phylum       Class          Order</span></span>
<span id="cb59-292"><a href="#cb59-292" aria-hidden="true" tabindex="-1"></a><span class="in">ASV7   Eukaryota Mucoromycota Glomeromycetes Glomerales</span></span>
<span id="cb59-293"><a href="#cb59-293" aria-hidden="true" tabindex="-1"></a><span class="in">ASV17  Eukaryota Mucoromycota Glomeromycetes Glomerales</span></span>
<span id="cb59-294"><a href="#cb59-294" aria-hidden="true" tabindex="-1"></a><span class="in">ASV245 Eukaryota Mucoromycota Glomeromycetes Glomerales</span></span>
<span id="cb59-295"><a href="#cb59-295" aria-hidden="true" tabindex="-1"></a><span class="in">ASV214 Eukaryota Mucoromycota Glomeromycetes Glomerales</span></span>
<span id="cb59-296"><a href="#cb59-296" aria-hidden="true" tabindex="-1"></a><span class="in">ASV401 Eukaryota Mucoromycota Glomeromycetes Glomerales</span></span>
<span id="cb59-297"><a href="#cb59-297" aria-hidden="true" tabindex="-1"></a><span class="in">ASV57  Eukaryota Mucoromycota Glomeromycetes Glomerales</span></span>
<span id="cb59-298"><a href="#cb59-298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-299"><a href="#cb59-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-300"><a href="#cb59-300" aria-hidden="true" tabindex="-1"></a>Next we need to add rank definitions (e.g., <span class="in">`k__`</span>, <span class="in">`p__`</span>, etc.) to each classification. </span>
<span id="cb59-301"><a href="#cb59-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-304"><a href="#cb59-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-305"><a href="#cb59-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-306"><a href="#cb59-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-307"><a href="#cb59-307" aria-hidden="true" tabindex="-1"></a>tmp_tax <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">tax_table</span>(physeq))   </span>
<span id="cb59-308"><a href="#cb59-308" aria-hidden="true" tabindex="-1"></a>tmp_tax <span class="ot">&lt;-</span> tmp_tax <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"Kingdom"</span> <span class="ot">=</span> <span class="st">"Domain"</span>)</span>
<span id="cb59-309"><a href="#cb59-309" aria-hidden="true" tabindex="-1"></a>tmp_tax <span class="ot">&lt;-</span> tmp_tax <span class="sc">%&gt;%</span></span>
<span id="cb59-310"><a href="#cb59-310" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate_all</span>(<span class="sc">~</span>stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(., <span class="st">"</span><span class="sc">\\</span><span class="st">?"</span>, <span class="st">""</span>))</span>
<span id="cb59-311"><a href="#cb59-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-312"><a href="#cb59-312" aria-hidden="true" tabindex="-1"></a>tmp_tax<span class="sc">$</span>Kingdom <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"k"</span>, tmp_tax<span class="sc">$</span>Kingdom, <span class="at">sep =</span> <span class="st">"__"</span>)</span>
<span id="cb59-313"><a href="#cb59-313" aria-hidden="true" tabindex="-1"></a>tmp_tax<span class="sc">$</span>Phylum <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"p"</span>, tmp_tax<span class="sc">$</span>Phylum, <span class="at">sep =</span> <span class="st">"__"</span>)</span>
<span id="cb59-314"><a href="#cb59-314" aria-hidden="true" tabindex="-1"></a>tmp_tax<span class="sc">$</span>Class <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"c"</span>, tmp_tax<span class="sc">$</span>Class, <span class="at">sep =</span> <span class="st">"__"</span>)</span>
<span id="cb59-315"><a href="#cb59-315" aria-hidden="true" tabindex="-1"></a>tmp_tax<span class="sc">$</span>Order <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"o"</span>, tmp_tax<span class="sc">$</span>Order, <span class="at">sep =</span> <span class="st">"__"</span>)</span>
<span id="cb59-316"><a href="#cb59-316" aria-hidden="true" tabindex="-1"></a>tmp_tax<span class="sc">$</span>Family <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"f"</span>, tmp_tax<span class="sc">$</span>Family, <span class="at">sep =</span> <span class="st">"__"</span>)</span>
<span id="cb59-317"><a href="#cb59-317" aria-hidden="true" tabindex="-1"></a>tmp_tax<span class="sc">$</span>Genus <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"g"</span>, tmp_tax<span class="sc">$</span>Genus, <span class="at">sep =</span> <span class="st">"__"</span>)</span>
<span id="cb59-318"><a href="#cb59-318" aria-hidden="true" tabindex="-1"></a>tmp_tax<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"s"</span>, tmp_tax<span class="sc">$</span>Species, <span class="at">sep =</span> <span class="st">"__"</span>)</span>
<span id="cb59-319"><a href="#cb59-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-320"><a href="#cb59-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-321"><a href="#cb59-321" aria-hidden="true" tabindex="-1"></a>And now the final, modified taxonomy table.</span>
<span id="cb59-322"><a href="#cb59-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-325"><a href="#cb59-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-326"><a href="#cb59-326" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-327"><a href="#cb59-327" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-328"><a href="#cb59-328" aria-hidden="true" tabindex="-1"></a>tmp_tax[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb59-329"><a href="#cb59-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-330"><a href="#cb59-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-331"><a href="#cb59-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-332"><a href="#cb59-332" aria-hidden="true" tabindex="-1"></a><span class="in">       Kingdom      Phylum          Class             Order</span></span>
<span id="cb59-333"><a href="#cb59-333" aria-hidden="true" tabindex="-1"></a><span class="in">ASV7   k__Eukaryota p__Mucoromycota c__Glomeromycetes o__Glomerales</span></span>
<span id="cb59-334"><a href="#cb59-334" aria-hidden="true" tabindex="-1"></a><span class="in">ASV17  k__Eukaryota p__Mucoromycota c__Glomeromycetes o__Glomerales</span></span>
<span id="cb59-335"><a href="#cb59-335" aria-hidden="true" tabindex="-1"></a><span class="in">ASV245 k__Eukaryota p__Mucoromycota c__Glomeromycetes o__Glomerales</span></span>
<span id="cb59-336"><a href="#cb59-336" aria-hidden="true" tabindex="-1"></a><span class="in">ASV214 k__Eukaryota p__Mucoromycota c__Glomeromycetes o__Glomerales</span></span>
<span id="cb59-337"><a href="#cb59-337" aria-hidden="true" tabindex="-1"></a><span class="in">ASV401 k__Eukaryota p__Mucoromycota c__Glomeromycetes o__Glomerales</span></span>
<span id="cb59-338"><a href="#cb59-338" aria-hidden="true" tabindex="-1"></a><span class="in">ASV57  k__Eukaryota p__Mucoromycota c__Glomeromycetes o__Glomerales</span></span>
<span id="cb59-339"><a href="#cb59-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-340"><a href="#cb59-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-341"><a href="#cb59-341" aria-hidden="true" tabindex="-1"></a><span class="fu">### B. Sequence Table</span></span>
<span id="cb59-342"><a href="#cb59-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-343"><a href="#cb59-343" aria-hidden="true" tabindex="-1"></a>Here is what the sequence table looks like in the dataset.</span>
<span id="cb59-344"><a href="#cb59-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-347"><a href="#cb59-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-348"><a href="#cb59-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-349"><a href="#cb59-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-350"><a href="#cb59-350" aria-hidden="true" tabindex="-1"></a>tmp_otu[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb59-351"><a href="#cb59-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-352"><a href="#cb59-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-353"><a href="#cb59-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-354"><a href="#cb59-354" aria-hidden="true" tabindex="-1"></a><span class="in">       P00_D00_000_NNN P01_D00_010_W4A P01_D10_020_W4A</span></span>
<span id="cb59-355"><a href="#cb59-355" aria-hidden="true" tabindex="-1"></a><span class="in">ASV7              1340               4             657 </span></span>
<span id="cb59-356"><a href="#cb59-356" aria-hidden="true" tabindex="-1"></a><span class="in">ASV17                4               0               0 </span></span>
<span id="cb59-357"><a href="#cb59-357" aria-hidden="true" tabindex="-1"></a><span class="in">ASV245               0               0               0 </span></span>
<span id="cb59-358"><a href="#cb59-358" aria-hidden="true" tabindex="-1"></a><span class="in">ASV214               0               0               0 </span></span>
<span id="cb59-359"><a href="#cb59-359" aria-hidden="true" tabindex="-1"></a><span class="in">ASV401               0               0               0 </span></span>
<span id="cb59-360"><a href="#cb59-360" aria-hidden="true" tabindex="-1"></a><span class="in">ASV57              699               0               0 </span></span>
<span id="cb59-361"><a href="#cb59-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-362"><a href="#cb59-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-365"><a href="#cb59-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-366"><a href="#cb59-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-367"><a href="#cb59-367" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-368"><a href="#cb59-368" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">row.names</span>(tmp_otu), <span class="fu">row.names</span>(tmp_tax))</span>
<span id="cb59-369"><a href="#cb59-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-370"><a href="#cb59-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-371"><a href="#cb59-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-372"><a href="#cb59-372" aria-hidden="true" tabindex="-1"></a><span class="in">[1] TRUE</span></span>
<span id="cb59-373"><a href="#cb59-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-374"><a href="#cb59-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-375"><a href="#cb59-375" aria-hidden="true" tabindex="-1"></a><span class="fu">### C. Sample Table</span></span>
<span id="cb59-376"><a href="#cb59-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-377"><a href="#cb59-377" aria-hidden="true" tabindex="-1"></a>Here is what the sample table looks like.</span>
<span id="cb59-378"><a href="#cb59-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-381"><a href="#cb59-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-382"><a href="#cb59-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-383"><a href="#cb59-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-384"><a href="#cb59-384" aria-hidden="true" tabindex="-1"></a>sample_tab[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb59-385"><a href="#cb59-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-386"><a href="#cb59-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-389"><a href="#cb59-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-390"><a href="#cb59-390" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-391"><a href="#cb59-391" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-392"><a href="#cb59-392" aria-hidden="true" tabindex="-1"></a>sample_tab <span class="ot">&lt;-</span> sample_tab <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"SampleID"</span>)</span>
<span id="cb59-393"><a href="#cb59-393" aria-hidden="true" tabindex="-1"></a>sample_tab<span class="sc">$</span>SampleID <span class="ot">&lt;-</span> <span class="fu">rownames</span>(sample_tab)</span>
<span id="cb59-394"><a href="#cb59-394" aria-hidden="true" tabindex="-1"></a>sample_tab <span class="ot">&lt;-</span> sample_tab <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">relocate</span>(SampleID)</span>
<span id="cb59-395"><a href="#cb59-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-396"><a href="#cb59-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-397"><a href="#cb59-397" aria-hidden="true" tabindex="-1"></a><span class="fu">## Create a Microtable Object</span></span>
<span id="cb59-398"><a href="#cb59-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-399"><a href="#cb59-399" aria-hidden="true" tabindex="-1"></a>With these three files in hand we are now ready to create a <span class="co">[</span><span class="ot">microtable object</span><span class="co">](https://chiliubio.github.io/microeco_tutorial/basic-class.html)</span>.</span>
<span id="cb59-400"><a href="#cb59-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-401"><a href="#cb59-401" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb59-402"><a href="#cb59-402" aria-hidden="true" tabindex="-1"></a>A <span class="co">[</span><span class="ot">microtable object</span><span class="co">](https://chiliubio.github.io/microeco_tutorial/basic-class.html)</span> contains an ASV table (taxa abundances), sample metadata, and taxonomy table (mapping between ASVs and higher-level taxonomic classifications). It can also contain a phylogenetic tree of ASVs as well as representative sequences of each ASV. </span>
<span id="cb59-403"><a href="#cb59-403" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb59-404"><a href="#cb59-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-407"><a href="#cb59-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-408"><a href="#cb59-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-409"><a href="#cb59-409" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-410"><a href="#cb59-410" aria-hidden="true" tabindex="-1"></a>sample_tab <span class="ot">&lt;-</span> sample_tab</span>
<span id="cb59-411"><a href="#cb59-411" aria-hidden="true" tabindex="-1"></a>tax_tab <span class="ot">&lt;-</span> tmp_tax</span>
<span id="cb59-412"><a href="#cb59-412" aria-hidden="true" tabindex="-1"></a>otu_tab <span class="ot">&lt;-</span> tmp_otu</span>
<span id="cb59-413"><a href="#cb59-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-414"><a href="#cb59-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-417"><a href="#cb59-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-418"><a href="#cb59-418" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-419"><a href="#cb59-419" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-420"><a href="#cb59-420" aria-hidden="true" tabindex="-1"></a>tmp_me <span class="ot">&lt;-</span> microtable<span class="sc">$</span><span class="fu">new</span>(<span class="at">sample_table =</span> sample_tab, </span>
<span id="cb59-421"><a href="#cb59-421" aria-hidden="true" tabindex="-1"></a>                         <span class="at">otu_table =</span> otu_tab, </span>
<span id="cb59-422"><a href="#cb59-422" aria-hidden="true" tabindex="-1"></a>                         <span class="at">tax_table =</span> tax_tab)</span>
<span id="cb59-423"><a href="#cb59-423" aria-hidden="true" tabindex="-1"></a>tmp_me</span>
<span id="cb59-424"><a href="#cb59-424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-425"><a href="#cb59-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-426"><a href="#cb59-426" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb59-427"><a href="#cb59-427" aria-hidden="true" tabindex="-1"></a><span class="in">microtable-class object:</span></span>
<span id="cb59-428"><a href="#cb59-428" aria-hidden="true" tabindex="-1"></a><span class="in">sample_table have 41 rows and 19 columns</span></span>
<span id="cb59-429"><a href="#cb59-429" aria-hidden="true" tabindex="-1"></a><span class="in">otu_table have 883 rows and 41 columns</span></span>
<span id="cb59-430"><a href="#cb59-430" aria-hidden="true" tabindex="-1"></a><span class="in">tax_table have 883 rows and 7 columns</span></span>
<span id="cb59-431"><a href="#cb59-431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-432"><a href="#cb59-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-433"><a href="#cb59-433" aria-hidden="true" tabindex="-1"></a><span class="fu">### D. Add Representative Sequence</span></span>
<span id="cb59-434"><a href="#cb59-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-435"><a href="#cb59-435" aria-hidden="true" tabindex="-1"></a>We can also add representative sequences for each OTU/ASV. For this step, we can simply grab the sequences from the row names of the DADA2 taxonomy object loaded above.</span>
<span id="cb59-436"><a href="#cb59-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-439"><a href="#cb59-439" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-440"><a href="#cb59-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-441"><a href="#cb59-441" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-442"><a href="#cb59-442" aria-hidden="true" tabindex="-1"></a>rep_fasta <span class="ot">&lt;-</span> Biostrings<span class="sc">::</span><span class="fu">readDNAStringSet</span>(<span class="st">"working_files/LOTUS3/amf/OTU.fna"</span>)</span>
<span id="cb59-443"><a href="#cb59-443" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">row.names</span>(tmp_me<span class="sc">$</span>tax_table), <span class="fu">row.names</span>(tmp_me<span class="sc">$</span>otu_table))</span>
<span id="cb59-444"><a href="#cb59-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-445"><a href="#cb59-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-446"><a href="#cb59-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-447"><a href="#cb59-447" aria-hidden="true" tabindex="-1"></a><span class="in">[1] TRUE</span></span>
<span id="cb59-448"><a href="#cb59-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-449"><a href="#cb59-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-452"><a href="#cb59-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-453"><a href="#cb59-453" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-454"><a href="#cb59-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-455"><a href="#cb59-455" aria-hidden="true" tabindex="-1"></a>tmp_fasta_names <span class="ot">&lt;-</span> <span class="fu">names</span>(rep_fasta)</span>
<span id="cb59-456"><a href="#cb59-456" aria-hidden="true" tabindex="-1"></a>tmp_rep_fasta <span class="ot">&lt;-</span> rep_fasta[<span class="fu">match</span>(<span class="fu">row.names</span>(tmp_me<span class="sc">$</span>tax_table), tmp_fasta_names)]</span>
<span id="cb59-457"><a href="#cb59-457" aria-hidden="true" tabindex="-1"></a>rep_fasta <span class="ot">&lt;-</span> tmp_rep_fasta</span>
<span id="cb59-458"><a href="#cb59-458" aria-hidden="true" tabindex="-1"></a>tmp_me<span class="sc">$</span>rep_fasta <span class="ot">&lt;-</span> rep_fasta</span>
<span id="cb59-459"><a href="#cb59-459" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">row.names</span>(tmp_me<span class="sc">$</span>tax_table), <span class="fu">names</span>(rep_fasta))</span>
<span id="cb59-460"><a href="#cb59-460" aria-hidden="true" tabindex="-1"></a>tmp_me<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb59-461"><a href="#cb59-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-462"><a href="#cb59-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-463"><a href="#cb59-463" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-464"><a href="#cb59-464" aria-hidden="true" tabindex="-1"></a><span class="in">[1] TRUE</span></span>
<span id="cb59-465"><a href="#cb59-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-466"><a href="#cb59-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-469"><a href="#cb59-469" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-470"><a href="#cb59-470" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-471"><a href="#cb59-471" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-472"><a href="#cb59-472" aria-hidden="true" tabindex="-1"></a>me_asv_raw <span class="ot">&lt;-</span> microeco<span class="sc">::</span><span class="fu">clone</span>(tmp_me)</span>
<span id="cb59-473"><a href="#cb59-473" aria-hidden="true" tabindex="-1"></a>me_asv_raw</span>
<span id="cb59-474"><a href="#cb59-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-475"><a href="#cb59-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-478"><a href="#cb59-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-479"><a href="#cb59-479" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-480"><a href="#cb59-480" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-481"><a href="#cb59-481" aria-hidden="true" tabindex="-1"></a>me_asv_raw</span>
<span id="cb59-482"><a href="#cb59-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-483"><a href="#cb59-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-484"><a href="#cb59-484" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The microeco object </span><span class="in">`me_asv_raw`</span><span class="at"> contains all data from the LotuS3 pipeline, before any dataset curation. </span></span>
<span id="cb59-485"><a href="#cb59-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-486"><a href="#cb59-486" aria-hidden="true" tabindex="-1"></a><span class="fu">## Curate the Data Set</span></span>
<span id="cb59-487"><a href="#cb59-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-488"><a href="#cb59-488" aria-hidden="true" tabindex="-1"></a>Pretty much the last thing to do is remove unwanted taxa, negative controls, and low-count samples.</span>
<span id="cb59-489"><a href="#cb59-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-490"><a href="#cb59-490" aria-hidden="true" tabindex="-1"></a><span class="fu">### Remove non-fungal ASVs</span></span>
<span id="cb59-491"><a href="#cb59-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-492"><a href="#cb59-492" aria-hidden="true" tabindex="-1"></a>First we can have a quick look at the kingdom and phylum level classifications to see what we are dealing with. </span>
<span id="cb59-493"><a href="#cb59-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-496"><a href="#cb59-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-497"><a href="#cb59-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-498"><a href="#cb59-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-499"><a href="#cb59-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: markup</span></span>
<span id="cb59-500"><a href="#cb59-500" aria-hidden="true" tabindex="-1"></a>tmp_k <span class="ot">&lt;-</span> me_asv_raw<span class="sc">$</span>tax_table <span class="sc">%&gt;%</span></span>
<span id="cb59-501"><a href="#cb59-501" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>(Kingdom, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-502"><a href="#cb59-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-503"><a href="#cb59-503" aria-hidden="true" tabindex="-1"></a>tmp_p <span class="ot">&lt;-</span> me_asv_raw<span class="sc">$</span>tax_table <span class="sc">%&gt;%</span></span>
<span id="cb59-504"><a href="#cb59-504" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>(Phylum, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-505"><a href="#cb59-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-506"><a href="#cb59-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-509"><a href="#cb59-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-510"><a href="#cb59-510" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-511"><a href="#cb59-511" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-512"><a href="#cb59-512" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: markup</span></span>
<span id="cb59-513"><a href="#cb59-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb59-514"><a href="#cb59-514" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"-------KINGDOM------------------"</span>)</span>
<span id="cb59-515"><a href="#cb59-515" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(tmp_k<span class="sc">$</span>Kingdom, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb59-516"><a href="#cb59-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-517"><a href="#cb59-517" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"-------PHYLUM------------------"</span>)</span>
<span id="cb59-518"><a href="#cb59-518" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(tmp_p<span class="sc">$</span>Phylum, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb59-519"><a href="#cb59-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-520"><a href="#cb59-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-521"><a href="#cb59-521" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The first thing to notice in at the kingdom level we only have Eukaryota and unclassified (or NA). We can remove anything with the NA at the kingdom level.  </span>
<span id="cb59-522"><a href="#cb59-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-523"><a href="#cb59-523" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>At the phylum level, we can see several non-fungal taxa as well as unclassified. We can remove any non-fungal taxa as well as any phylum level NAs. </span>
<span id="cb59-524"><a href="#cb59-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-525"><a href="#cb59-525" aria-hidden="true" tabindex="-1"></a>The easiest thing to do is keep everything we want--in other words, all fungal taxa.</span>
<span id="cb59-526"><a href="#cb59-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-529"><a href="#cb59-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-530"><a href="#cb59-530" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-531"><a href="#cb59-531" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-532"><a href="#cb59-532" aria-hidden="true" tabindex="-1"></a>tmp_no_na <span class="ot">&lt;-</span> microeco<span class="sc">::</span><span class="fu">clone</span>(tmp_me)</span>
<span id="cb59-533"><a href="#cb59-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-534"><a href="#cb59-534" aria-hidden="true" tabindex="-1"></a>tmp_no_na<span class="sc">$</span>tax_table <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb59-535"><a href="#cb59-535" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">subset</span>(Kingdom <span class="sc">==</span> <span class="st">"k__Eukaryota"</span>)</span>
<span id="cb59-536"><a href="#cb59-536" aria-hidden="true" tabindex="-1"></a>tmp_no_na<span class="sc">$</span>tax_table <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb59-537"><a href="#cb59-537" aria-hidden="true" tabindex="-1"></a>  base<span class="sc">::</span><span class="fu">subset</span>(Phylum <span class="sc">==</span> <span class="st">"p__Mucoromycota"</span> <span class="sc">|</span> </span>
<span id="cb59-538"><a href="#cb59-538" aria-hidden="true" tabindex="-1"></a>               Phylum <span class="sc">==</span>  <span class="st">"p__Ascomycota"</span> <span class="sc">|</span> </span>
<span id="cb59-539"><a href="#cb59-539" aria-hidden="true" tabindex="-1"></a>               Phylum <span class="sc">==</span>  <span class="st">"p__Basidiomycota"</span> <span class="sc">|</span> </span>
<span id="cb59-540"><a href="#cb59-540" aria-hidden="true" tabindex="-1"></a>               Phylum <span class="sc">==</span>  <span class="st">"p__Peronosporomycetes"</span> <span class="sc">|</span> </span>
<span id="cb59-541"><a href="#cb59-541" aria-hidden="true" tabindex="-1"></a>               Phylum <span class="sc">==</span>  <span class="st">"p__Zoopagomycota"</span> <span class="sc">|</span> </span>
<span id="cb59-542"><a href="#cb59-542" aria-hidden="true" tabindex="-1"></a>               Phylum <span class="sc">==</span>  <span class="st">"p__LKM15"</span> <span class="sc">|</span> </span>
<span id="cb59-543"><a href="#cb59-543" aria-hidden="true" tabindex="-1"></a>               Phylum <span class="sc">==</span>  <span class="st">"p__Aphelidea"</span> <span class="sc">|</span> </span>
<span id="cb59-544"><a href="#cb59-544" aria-hidden="true" tabindex="-1"></a>               Phylum <span class="sc">==</span>  <span class="st">"p__Chytridiomycota"</span> <span class="sc">|</span> </span>
<span id="cb59-545"><a href="#cb59-545" aria-hidden="true" tabindex="-1"></a>               Phylum <span class="sc">==</span>  <span class="st">"p__Cryptomycota"</span> <span class="sc">|</span> </span>
<span id="cb59-546"><a href="#cb59-546" aria-hidden="true" tabindex="-1"></a>               Phylum <span class="sc">==</span>  <span class="st">"p__Neocallimastigomycota"</span>)  </span>
<span id="cb59-547"><a href="#cb59-547" aria-hidden="true" tabindex="-1"></a>tmp_no_na<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb59-548"><a href="#cb59-548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-549"><a href="#cb59-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-552"><a href="#cb59-552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-553"><a href="#cb59-553" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-554"><a href="#cb59-554" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-555"><a href="#cb59-555" aria-hidden="true" tabindex="-1"></a>me_asv_no_na <span class="ot">&lt;-</span> microeco<span class="sc">::</span><span class="fu">clone</span>(tmp_no_na)</span>
<span id="cb59-556"><a href="#cb59-556" aria-hidden="true" tabindex="-1"></a>me_asv_no_na</span>
<span id="cb59-557"><a href="#cb59-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-558"><a href="#cb59-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-561"><a href="#cb59-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-562"><a href="#cb59-562" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-563"><a href="#cb59-563" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-564"><a href="#cb59-564" aria-hidden="true" tabindex="-1"></a>me_asv_no_na</span>
<span id="cb59-565"><a href="#cb59-565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-566"><a href="#cb59-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-567"><a href="#cb59-567" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The microeco object </span><span class="in">`me_asv_no_na`</span><span class="at"> conatins only ASVs classified as Fungi. </span></span>
<span id="cb59-568"><a href="#cb59-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-569"><a href="#cb59-569" aria-hidden="true" tabindex="-1"></a><span class="fu">### Remove Negative Controls (NC)</span></span>
<span id="cb59-570"><a href="#cb59-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-571"><a href="#cb59-571" aria-hidden="true" tabindex="-1"></a>Now we need to remove the NC samples *and* ASVs found in those sample. We first identified all ASVs that were present in at least one NC sample represented by at least 1 read. We did this by sub-setting the NC samples from the new microtable object.</span>
<span id="cb59-572"><a href="#cb59-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-575"><a href="#cb59-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-576"><a href="#cb59-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-577"><a href="#cb59-577" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-578"><a href="#cb59-578" aria-hidden="true" tabindex="-1"></a>tmp_nc <span class="ot">&lt;-</span> microeco<span class="sc">::</span><span class="fu">clone</span>(tmp_no_na)</span>
<span id="cb59-579"><a href="#cb59-579" aria-hidden="true" tabindex="-1"></a>tmp_nc<span class="sc">$</span>sample_table <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmp_nc<span class="sc">$</span>sample_table, Treatment <span class="sc">==</span> <span class="st">"Negative"</span>)</span>
<span id="cb59-580"><a href="#cb59-580" aria-hidden="true" tabindex="-1"></a>tmp_nc<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb59-581"><a href="#cb59-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-582"><a href="#cb59-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-583"><a href="#cb59-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-584"><a href="#cb59-584" aria-hidden="true" tabindex="-1"></a><span class="in">527 taxa with 0 abundance are removed from the otu_table ...</span></span>
<span id="cb59-585"><a href="#cb59-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-586"><a href="#cb59-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-589"><a href="#cb59-589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-590"><a href="#cb59-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-591"><a href="#cb59-591" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-592"><a href="#cb59-592" aria-hidden="true" tabindex="-1"></a>me_asv_nc <span class="ot">&lt;-</span> microeco<span class="sc">::</span><span class="fu">clone</span>(tmp_nc)</span>
<span id="cb59-593"><a href="#cb59-593" aria-hidden="true" tabindex="-1"></a>me_asv_nc</span>
<span id="cb59-594"><a href="#cb59-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-595"><a href="#cb59-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-596"><a href="#cb59-596" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The microeco object </span><span class="in">`me_asv_nc`</span><span class="at"> conatins only the negative control sample(s) and associated ASVs. </span></span>
<span id="cb59-597"><a href="#cb59-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-598"><a href="#cb59-598" aria-hidden="true" tabindex="-1"></a>Looks like there are <span class="in">`r nrow(me_asv_nc$tax_table)`</span> ASVs in the NC samples from a total of <span class="in">`r sum(me_asv_nc$taxa_sums())`</span> reads.</span>
<span id="cb59-599"><a href="#cb59-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-602"><a href="#cb59-602" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-603"><a href="#cb59-603" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-604"><a href="#cb59-604" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-605"><a href="#cb59-605" aria-hidden="true" tabindex="-1"></a>nc_asvs <span class="ot">&lt;-</span> <span class="fu">row.names</span>(tmp_nc<span class="sc">$</span>tax_table)</span>
<span id="cb59-606"><a href="#cb59-606" aria-hidden="true" tabindex="-1"></a>nc_asvs</span>
<span id="cb59-607"><a href="#cb59-607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-608"><a href="#cb59-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-611"><a href="#cb59-611" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-612"><a href="#cb59-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-613"><a href="#cb59-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-614"><a href="#cb59-614" aria-hidden="true" tabindex="-1"></a>nc_asvs</span>
<span id="cb59-615"><a href="#cb59-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-616"><a href="#cb59-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-617"><a href="#cb59-617" aria-hidden="true" tabindex="-1"></a>There are <span class="in">`r length(nc_asvs)`</span> ASVs found in the NC sample. ASVs are numbered in order by total abundance in the data set so we know that many of the ASVs in the NC samples are not particularly abundant in the dataset. That said, there are numerous low number ASVs (e.g. ASV1, ASV2, ASV7, etc.) that are found in NC samples.</span>
<span id="cb59-618"><a href="#cb59-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-619"><a href="#cb59-619" aria-hidden="true" tabindex="-1"></a>We can look at the abundance of these ASVs across all samples and compare it to the NC. This takes a bit of wrangling.</span>
<span id="cb59-620"><a href="#cb59-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-621"><a href="#cb59-621" aria-hidden="true" tabindex="-1"></a>Essentially, for each ASV, the code below calculates:</span>
<span id="cb59-622"><a href="#cb59-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-623"><a href="#cb59-623" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The total number of NC samples containing at least 1 read.\</span>
<span id="cb59-624"><a href="#cb59-624" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The total number of reads in NC samples.\</span>
<span id="cb59-625"><a href="#cb59-625" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The total number of non-NC samples containing at least 1 read.\</span>
<span id="cb59-626"><a href="#cb59-626" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The total number of reads in non-NC samples.\</span>
<span id="cb59-627"><a href="#cb59-627" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The percent of reads in the NC samples and the percent of NC samples containing reads.</span>
<span id="cb59-628"><a href="#cb59-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-631"><a href="#cb59-631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-632"><a href="#cb59-632" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-633"><a href="#cb59-633" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-634"><a href="#cb59-634" aria-hidden="true" tabindex="-1"></a>tmp_rem_nc <span class="ot">&lt;-</span> microeco<span class="sc">::</span><span class="fu">clone</span>(tmp_no_na)</span>
<span id="cb59-635"><a href="#cb59-635" aria-hidden="true" tabindex="-1"></a>tmp_rem_nc_df <span class="ot">&lt;-</span> tmp_rem_nc<span class="sc">$</span>otu_table</span>
<span id="cb59-636"><a href="#cb59-636" aria-hidden="true" tabindex="-1"></a>tmp_rem_nc_df <span class="ot">&lt;-</span> tmp_rem_nc_df <span class="sc">%&gt;%</span> </span>
<span id="cb59-637"><a href="#cb59-637" aria-hidden="true" tabindex="-1"></a>                 dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">row.names</span>(tmp_rem_nc_df) <span class="sc">%in%</span> nc_asvs)</span>
<span id="cb59-638"><a href="#cb59-638" aria-hidden="true" tabindex="-1"></a>tmp_rem_nc_df <span class="ot">&lt;-</span> tmp_rem_nc_df <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ASV_ID"</span>)</span>
<span id="cb59-639"><a href="#cb59-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-640"><a href="#cb59-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-643"><a href="#cb59-643" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-644"><a href="#cb59-644" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-645"><a href="#cb59-645" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-646"><a href="#cb59-646" aria-hidden="true" tabindex="-1"></a>tmp_rem_nc_df <span class="ot">&lt;-</span> tmp_rem_nc_df  <span class="sc">%&gt;%</span> </span>
<span id="cb59-647"><a href="#cb59-647" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">total_reads_NC =</span> <span class="fu">rowSums</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(., <span class="fu">contains</span>(<span class="st">"NNN"</span>))), </span>
<span id="cb59-648"><a href="#cb59-648" aria-hidden="true" tabindex="-1"></a>         <span class="at">.after =</span> <span class="st">"ASV_ID"</span>)</span>
<span id="cb59-649"><a href="#cb59-649" aria-hidden="true" tabindex="-1"></a>tmp_rem_nc_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(tmp_rem_nc_df, <span class="sc">-</span><span class="fu">contains</span>(<span class="st">"NNN"</span>))</span>
<span id="cb59-650"><a href="#cb59-650" aria-hidden="true" tabindex="-1"></a>tmp_rem_nc_df <span class="ot">&lt;-</span> tmp_rem_nc_df <span class="sc">%&gt;%</span></span>
<span id="cb59-651"><a href="#cb59-651" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">total_reads_samps =</span> <span class="fu">rowSums</span>(.[<span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_rem_nc_df)]), </span>
<span id="cb59-652"><a href="#cb59-652" aria-hidden="true" tabindex="-1"></a>                <span class="at">.after =</span> <span class="st">"total_reads_NC"</span>)</span>
<span id="cb59-653"><a href="#cb59-653" aria-hidden="true" tabindex="-1"></a>tmp_rem_nc_df[, <span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(tmp_rem_nc_df)] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>)</span>
<span id="cb59-654"><a href="#cb59-654" aria-hidden="true" tabindex="-1"></a>tmp_rem_nc_df <span class="ot">&lt;-</span> tmp_rem_nc_df <span class="sc">%&gt;%</span></span>
<span id="cb59-655"><a href="#cb59-655" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc_in_neg =</span> <span class="dv">100</span><span class="sc">*</span>(</span>
<span id="cb59-656"><a href="#cb59-656" aria-hidden="true" tabindex="-1"></a>    total_reads_NC <span class="sc">/</span> (total_reads_NC <span class="sc">+</span> total_reads_samps)),</span>
<span id="cb59-657"><a href="#cb59-657" aria-hidden="true" tabindex="-1"></a>                <span class="at">.after =</span> <span class="st">"total_reads_samps"</span>)</span>
<span id="cb59-658"><a href="#cb59-658" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-659"><a href="#cb59-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-662"><a href="#cb59-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-663"><a href="#cb59-663" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-664"><a href="#cb59-664" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-665"><a href="#cb59-665" aria-hidden="true" tabindex="-1"></a>tmp_rem_nc_df<span class="sc">$</span>perc_in_neg <span class="ot">&lt;-</span> <span class="fu">round</span>(tmp_rem_nc_df<span class="sc">$</span>perc_in_neg, <span class="at">digits =</span> <span class="dv">6</span>)</span>
<span id="cb59-666"><a href="#cb59-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-667"><a href="#cb59-667" aria-hidden="true" tabindex="-1"></a>tmp_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowSums</span>(tmp_rem_nc<span class="sc">$</span>otu_table <span class="sc">!=</span> <span class="dv">0</span>))</span>
<span id="cb59-668"><a href="#cb59-668" aria-hidden="true" tabindex="-1"></a>tmp_1 <span class="ot">&lt;-</span> tmp_1 <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ASV_ID"</span>)</span>
<span id="cb59-669"><a href="#cb59-669" aria-hidden="true" tabindex="-1"></a>tmp_1 <span class="ot">&lt;-</span> tmp_1 <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"total_samples"</span> <span class="ot">=</span> <span class="dv">2</span>)  </span>
<span id="cb59-670"><a href="#cb59-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-671"><a href="#cb59-671" aria-hidden="true" tabindex="-1"></a>tmp_2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(tmp_rem_nc<span class="sc">$</span>otu_table, <span class="fu">contains</span>(<span class="st">"NNN"</span>))</span>
<span id="cb59-672"><a href="#cb59-672" aria-hidden="true" tabindex="-1"></a>tmp_2<span class="sc">$</span>num_samp_nc <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(tmp_2 <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb59-673"><a href="#cb59-673" aria-hidden="true" tabindex="-1"></a>tmp_2 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(tmp_2, <span class="fu">contains</span>(<span class="st">"num_samp_nc"</span>))</span>
<span id="cb59-674"><a href="#cb59-674" aria-hidden="true" tabindex="-1"></a>tmp_2 <span class="ot">&lt;-</span> tmp_2 <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ASV_ID"</span>)</span>
<span id="cb59-675"><a href="#cb59-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-676"><a href="#cb59-676" aria-hidden="true" tabindex="-1"></a>tmp_3 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(tmp_rem_nc<span class="sc">$</span>otu_table, <span class="sc">-</span><span class="fu">contains</span>(<span class="st">"NNN"</span>))</span>
<span id="cb59-677"><a href="#cb59-677" aria-hidden="true" tabindex="-1"></a>tmp_3<span class="sc">$</span>num_samp_no_nc <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(tmp_3 <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb59-678"><a href="#cb59-678" aria-hidden="true" tabindex="-1"></a>tmp_3 <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(tmp_3, <span class="fu">contains</span>(<span class="st">"num_samp_no_nc"</span>))</span>
<span id="cb59-679"><a href="#cb59-679" aria-hidden="true" tabindex="-1"></a>tmp_3 <span class="ot">&lt;-</span> tmp_3 <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ASV_ID"</span>)</span>
<span id="cb59-680"><a href="#cb59-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-681"><a href="#cb59-681" aria-hidden="true" tabindex="-1"></a>tmp_rem_nc_df <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_rem_nc_df, tmp_1) <span class="sc">%&gt;%</span></span>
<span id="cb59-682"><a href="#cb59-682" aria-hidden="true" tabindex="-1"></a>                 dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_2) <span class="sc">%&gt;%</span></span>
<span id="cb59-683"><a href="#cb59-683" aria-hidden="true" tabindex="-1"></a>                 dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_3)</span>
<span id="cb59-684"><a href="#cb59-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-685"><a href="#cb59-685" aria-hidden="true" tabindex="-1"></a>tmp_rem_nc_df <span class="ot">&lt;-</span> tmp_rem_nc_df <span class="sc">%&gt;%</span></span>
<span id="cb59-686"><a href="#cb59-686" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">perc_in_neg_samp =</span> <span class="dv">100</span><span class="sc">*</span>( num_samp_nc <span class="sc">/</span> (num_samp_nc <span class="sc">+</span> num_samp_no_nc)),</span>
<span id="cb59-687"><a href="#cb59-687" aria-hidden="true" tabindex="-1"></a>                <span class="at">.after =</span> <span class="st">"num_samp_no_nc"</span>)</span>
<span id="cb59-688"><a href="#cb59-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-689"><a href="#cb59-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-692"><a href="#cb59-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-693"><a href="#cb59-693" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-694"><a href="#cb59-694" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-695"><a href="#cb59-695" aria-hidden="true" tabindex="-1"></a>nc_check <span class="ot">&lt;-</span> tmp_rem_nc_df</span>
<span id="cb59-696"><a href="#cb59-696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-697"><a href="#cb59-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-700"><a href="#cb59-700" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-701"><a href="#cb59-701" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-702"><a href="#cb59-702" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-703"><a href="#cb59-703" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-make-asv-in-nc-table-amf</span></span>
<span id="cb59-704"><a href="#cb59-704" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Summary of ASVs detected in Negative Control (NC) samples."</span></span>
<span id="cb59-705"><a href="#cb59-705" aria-hidden="true" tabindex="-1"></a><span class="fu">make_asv_in_nc_table</span>(nc_check)</span>
<span id="cb59-706"><a href="#cb59-706" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-707"><a href="#cb59-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-708"><a href="#cb59-708" aria-hidden="true" tabindex="-1"></a>{{&lt; downloadthis files/CURATE/amf_asv_in_nc_samples.txt dname=amf_asv_in_nc_samples label="Download ASVs in NC samples" icon=table type=primary class=data-button id=asv_in_nc_samples &gt;}}</span>
<span id="cb59-709"><a href="#cb59-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-710"><a href="#cb59-710" aria-hidden="true" tabindex="-1"></a>Looking at these data we can see that some of the abundant ASVs like ASV1, ASV2, and ASV7 are found in the negative control sample but make up less than 10% of total reads. Other abundant ASVs like ASV21, ASV51, and ASV57 however are more abundant in the NC sample, comprising greater than 10% of total reads. We should remove any ASVs that are relatively abundant in the NC sample, specifically remove any ASVs where...</span>
<span id="cb59-711"><a href="#cb59-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-712"><a href="#cb59-712" aria-hidden="true" tabindex="-1"></a><span class="ss">1.   </span>the number of reads found in NC samples accounted for more than 10% of total reads</span>
<span id="cb59-713"><a href="#cb59-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-714"><a href="#cb59-714" aria-hidden="true" tabindex="-1"></a>We can also consider the following criteria to further filtering out potential contamination. </span>
<span id="cb59-715"><a href="#cb59-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-716"><a href="#cb59-716" aria-hidden="true" tabindex="-1"></a><span class="ss">2.   </span>the percent of NC samples containing the ASV was greater than 10% of total samples. </span>
<span id="cb59-717"><a href="#cb59-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-718"><a href="#cb59-718" aria-hidden="true" tabindex="-1"></a>However, since we only have 1 NC sample the second criteria does not make much sense. Consider ASV71--3940 total reads, 1 of which was found in the NC sample, or 0.025%. So that does not meet our first criteria. But ASV71 is only found in 5 samples (including the NC) which means that the percent of NC samples containing ASV71 is 20%, which meets our second criteria and should be removed. But I think we can safely retain ASV71 or any ASV that is only found in a few samples and low abundance in the NC sample.</span>
<span id="cb59-719"><a href="#cb59-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-720"><a href="#cb59-720" aria-hidden="true" tabindex="-1"></a>So instead we will remove any ASVs that are represented by &gt;10% of total reads OR found in fewer than 10% of non-NC samples.  </span>
<span id="cb59-721"><a href="#cb59-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-724"><a href="#cb59-724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-725"><a href="#cb59-725" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-726"><a href="#cb59-726" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-727"><a href="#cb59-727" aria-hidden="true" tabindex="-1"></a>nc_remove <span class="ot">&lt;-</span> nc_check <span class="sc">%&gt;%</span> </span>
<span id="cb59-728"><a href="#cb59-728" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(perc_in_neg <span class="sc">&gt;</span> <span class="dv">10</span> <span class="sc">|</span> num_samp_no_nc <span class="sc">&lt;</span> <span class="dv">4</span>)</span>
<span id="cb59-729"><a href="#cb59-729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-730"><a href="#cb59-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-733"><a href="#cb59-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-734"><a href="#cb59-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-735"><a href="#cb59-735" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-736"><a href="#cb59-736" aria-hidden="true" tabindex="-1"></a>nc_remain <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">anti_join</span>(nc_check, nc_remove)</span>
<span id="cb59-737"><a href="#cb59-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-738"><a href="#cb59-738" aria-hidden="true" tabindex="-1"></a>rem_nc_reads <span class="ot">&lt;-</span> <span class="fu">sum</span>(nc_remove<span class="sc">$</span>total_reads_NC)</span>
<span id="cb59-739"><a href="#cb59-739" aria-hidden="true" tabindex="-1"></a>rem_sam_reads <span class="ot">&lt;-</span> <span class="fu">sum</span>(nc_remove<span class="sc">$</span>total_reads_samps)</span>
<span id="cb59-740"><a href="#cb59-740" aria-hidden="true" tabindex="-1"></a>per_reads_rem <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>( rem_nc_reads <span class="sc">/</span> (rem_nc_reads <span class="sc">+</span> rem_sam_reads)), </span>
<span id="cb59-741"><a href="#cb59-741" aria-hidden="true" tabindex="-1"></a>                       <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb59-742"><a href="#cb59-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-743"><a href="#cb59-743" aria-hidden="true" tabindex="-1"></a>ret_nc_reads <span class="ot">&lt;-</span> <span class="fu">sum</span>(nc_remain<span class="sc">$</span>total_reads_NC)</span>
<span id="cb59-744"><a href="#cb59-744" aria-hidden="true" tabindex="-1"></a>ret_sam_reads <span class="ot">&lt;-</span> <span class="fu">sum</span>(nc_remain<span class="sc">$</span>total_reads_samps)</span>
<span id="cb59-745"><a href="#cb59-745" aria-hidden="true" tabindex="-1"></a>per_reads_ret <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>( ret_nc_reads <span class="sc">/</span> (ret_nc_reads <span class="sc">+</span> ret_sam_reads)), </span>
<span id="cb59-746"><a href="#cb59-746" aria-hidden="true" tabindex="-1"></a>                       <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb59-747"><a href="#cb59-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-748"><a href="#cb59-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-749"><a href="#cb59-749" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>          <span class="pp">|</span> Total ASVs          <span class="pp">|</span> NC reads         <span class="pp">|</span> non NC reads      <span class="pp">|</span> \% NC reads       <span class="pp">|</span></span>
<span id="cb59-750"><a href="#cb59-750" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|---------------------|------------------|-------------------|-------------------|</span></span>
<span id="cb59-751"><a href="#cb59-751" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Removed  <span class="pp">|</span> <span class="in">`r nrow(nc_remove)`</span> <span class="pp">|</span> <span class="in">`r rem_nc_reads`</span> <span class="pp">|</span> <span class="in">`r rem_sam_reads`</span> <span class="pp">|</span> <span class="in">`r per_reads_rem`</span> <span class="pp">|</span></span>
<span id="cb59-752"><a href="#cb59-752" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Retained <span class="pp">|</span> <span class="in">`r nrow(nc_remain)`</span> <span class="pp">|</span> <span class="in">`r ret_nc_reads`</span> <span class="pp">|</span> <span class="in">`r ret_sam_reads`</span> <span class="pp">|</span> <span class="in">`r per_reads_ret`</span> <span class="pp">|</span></span>
<span id="cb59-753"><a href="#cb59-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-754"><a href="#cb59-754" aria-hidden="true" tabindex="-1"></a>We identified a total of <span class="in">`r nrow(nc_check)`</span> ASVs that were present in at least 1 NC sample by at least 1 read. We removed any ASV where more than 10% of total reads were found in NC samples OR any ASV found in less than 10% of non-NC samples. Based on these criteria we removed <span class="in">`r nrow(nc_remove)`</span> ASVs from the data set, which represented <span class="in">`r rem_nc_reads`</span> total reads in NC samples and <span class="in">`r rem_sam_reads`</span> total reads in non-NC samples. Of the total reads removed <span class="in">`r per_reads_rem`</span>% came from NC samples. Of all ASVs identified in NC samples,<span class="in">`r nrow(nc_remain)`</span> were retained because the fell below the threshhold criteria. These ASVs accounted for <span class="in">`r ret_nc_reads`</span> reads in NC samples and <span class="in">`r ret_sam_reads`</span> reads in non-NC samples. NC samples accounted for <span class="in">`r per_reads_ret`</span>% of these reads.</span>
<span id="cb59-755"><a href="#cb59-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-756"><a href="#cb59-756" aria-hidden="true" tabindex="-1"></a>OK, now we can remove the NC samples and any ASVs that met our criteria described above.</span>
<span id="cb59-757"><a href="#cb59-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-760"><a href="#cb59-760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-761"><a href="#cb59-761" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-762"><a href="#cb59-762" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-763"><a href="#cb59-763" aria-hidden="true" tabindex="-1"></a>tmp_no_nc <span class="ot">&lt;-</span> microeco<span class="sc">::</span><span class="fu">clone</span>(tmp_no_na)</span>
<span id="cb59-764"><a href="#cb59-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-765"><a href="#cb59-765" aria-hidden="true" tabindex="-1"></a>tmp_rem_asv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(nc_remove<span class="sc">$</span>ASV_ID)</span>
<span id="cb59-766"><a href="#cb59-766" aria-hidden="true" tabindex="-1"></a>tmp_no_nc<span class="sc">$</span>otu_table <span class="ot">&lt;-</span> tmp_rem_nc<span class="sc">$</span>otu_table <span class="sc">%&gt;%</span> </span>
<span id="cb59-767"><a href="#cb59-767" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">row.names</span>(tmp_no_nc<span class="sc">$</span>otu_table) <span class="sc">%in%</span> tmp_rem_asv)</span>
<span id="cb59-768"><a href="#cb59-768" aria-hidden="true" tabindex="-1"></a>tmp_no_nc<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb59-769"><a href="#cb59-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-770"><a href="#cb59-770" aria-hidden="true" tabindex="-1"></a>tmp_no_nc<span class="sc">$</span>sample_table <span class="ot">&lt;-</span> <span class="fu">subset</span>(tmp_no_nc<span class="sc">$</span>sample_table, </span>
<span id="cb59-771"><a href="#cb59-771" aria-hidden="true" tabindex="-1"></a>                                 Treatment <span class="sc">!=</span> <span class="st">"Negative"</span>)</span>
<span id="cb59-772"><a href="#cb59-772" aria-hidden="true" tabindex="-1"></a>tmp_no_nc<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb59-773"><a href="#cb59-773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-774"><a href="#cb59-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-777"><a href="#cb59-777" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-778"><a href="#cb59-778" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-779"><a href="#cb59-779" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-780"><a href="#cb59-780" aria-hidden="true" tabindex="-1"></a>me_asv_no_nc <span class="ot">&lt;-</span> microeco<span class="sc">::</span><span class="fu">clone</span>(tmp_no_nc)</span>
<span id="cb59-781"><a href="#cb59-781" aria-hidden="true" tabindex="-1"></a>me_asv_no_nc</span>
<span id="cb59-782"><a href="#cb59-782" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-783"><a href="#cb59-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-786"><a href="#cb59-786" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-787"><a href="#cb59-787" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-788"><a href="#cb59-788" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-789"><a href="#cb59-789" aria-hidden="true" tabindex="-1"></a>me_asv_no_nc</span>
<span id="cb59-790"><a href="#cb59-790" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-791"><a href="#cb59-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-792"><a href="#cb59-792" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The microeco object </span><span class="in">`me_asv_no_nc`</span><span class="at"> does not conatins the negative control sample(s). </span></span>
<span id="cb59-793"><a href="#cb59-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-794"><a href="#cb59-794" aria-hidden="true" tabindex="-1"></a><span class="fu">### Remove Low-Count Samples</span></span>
<span id="cb59-795"><a href="#cb59-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-796"><a href="#cb59-796" aria-hidden="true" tabindex="-1"></a>Next, we can remove samples with really low read counts---here we set the threshold to <span class="in">`1000`</span> reads.</span>
<span id="cb59-797"><a href="#cb59-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-800"><a href="#cb59-800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-801"><a href="#cb59-801" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-802"><a href="#cb59-802" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-803"><a href="#cb59-803" aria-hidden="true" tabindex="-1"></a>tmp_no_low <span class="ot">&lt;-</span> microeco<span class="sc">::</span><span class="fu">clone</span>(tmp_no_nc)</span>
<span id="cb59-804"><a href="#cb59-804" aria-hidden="true" tabindex="-1"></a>tmp_no_low<span class="sc">$</span>otu_table <span class="ot">&lt;-</span> tmp_no_nc<span class="sc">$</span>otu_table <span class="sc">%&gt;%</span></span>
<span id="cb59-805"><a href="#cb59-805" aria-hidden="true" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">where</span>(<span class="sc">~</span> <span class="fu">is.numeric</span>(.) <span class="sc">&amp;&amp;</span> <span class="fu">sum</span>(.) <span class="sc">&gt;=</span> <span class="dv">1000</span>))</span>
<span id="cb59-806"><a href="#cb59-806" aria-hidden="true" tabindex="-1"></a>tmp_no_low<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb59-807"><a href="#cb59-807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-808"><a href="#cb59-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-809"><a href="#cb59-809" aria-hidden="true" tabindex="-1"></a>Check if any row sum (i.e., ASVs) is equal to 0 after removing the negative control sample(s).</span>
<span id="cb59-810"><a href="#cb59-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-813"><a href="#cb59-813" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-814"><a href="#cb59-814" aria-hidden="true" tabindex="-1"></a>tmp_row_sums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(tmp_no_low<span class="sc">$</span>otu_table)</span>
<span id="cb59-815"><a href="#cb59-815" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(tmp_row_sums <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb59-816"><a href="#cb59-816" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-817"><a href="#cb59-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-818"><a href="#cb59-818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-819"><a href="#cb59-819" aria-hidden="true" tabindex="-1"></a><span class="in">[1] FALSE</span></span>
<span id="cb59-820"><a href="#cb59-820" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-821"><a href="#cb59-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-824"><a href="#cb59-824" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-825"><a href="#cb59-825" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-826"><a href="#cb59-826" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-827"><a href="#cb59-827" aria-hidden="true" tabindex="-1"></a>me_asv_no_low <span class="ot">&lt;-</span> microeco<span class="sc">::</span><span class="fu">clone</span>(tmp_no_low)</span>
<span id="cb59-828"><a href="#cb59-828" aria-hidden="true" tabindex="-1"></a>me_asv_no_low</span>
<span id="cb59-829"><a href="#cb59-829" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-830"><a href="#cb59-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-833"><a href="#cb59-833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-834"><a href="#cb59-834" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-835"><a href="#cb59-835" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-836"><a href="#cb59-836" aria-hidden="true" tabindex="-1"></a>me_asv_no_low</span>
<span id="cb59-837"><a href="#cb59-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-838"><a href="#cb59-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-839"><a href="#cb59-839" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The microeco object </span><span class="in">`me_asv_no_low`</span><span class="at"> does not conatins the low abundance samples. </span></span>
<span id="cb59-840"><a href="#cb59-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-841"><a href="#cb59-841" aria-hidden="true" tabindex="-1"></a>We will quickly add final read counts and ASVs, then create the final microtable object.</span>
<span id="cb59-842"><a href="#cb59-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-845"><a href="#cb59-845" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-846"><a href="#cb59-846" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-847"><a href="#cb59-847" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-848"><a href="#cb59-848" aria-hidden="true" tabindex="-1"></a>tmp_final_rc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(me_asv_no_low<span class="sc">$</span><span class="fu">sample_sums</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb59-849"><a href="#cb59-849" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SampleID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-850"><a href="#cb59-850" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"final_rc"</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb59-851"><a href="#cb59-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-852"><a href="#cb59-852" aria-hidden="true" tabindex="-1"></a>tmp_final_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(me_asv_no_low<span class="sc">$</span>otu_table))</span>
<span id="cb59-853"><a href="#cb59-853" aria-hidden="true" tabindex="-1"></a>tmp_final_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowSums</span>(tmp_final_asv <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-854"><a href="#cb59-854" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SampleID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-855"><a href="#cb59-855" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"final_asv"</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb59-856"><a href="#cb59-856" aria-hidden="true" tabindex="-1"></a>tmp_final <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(tmp_final_rc, tmp_final_asv)</span>
<span id="cb59-857"><a href="#cb59-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-858"><a href="#cb59-858" aria-hidden="true" tabindex="-1"></a>sample_tab <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">full_join</span>(sample_tab, tmp_final) <span class="sc">%&gt;%</span> </span>
<span id="cb59-859"><a href="#cb59-859" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">relocate</span>(<span class="fu">c</span>(final_rc, final_asv), <span class="at">.after =</span> lotus3_asv)</span>
<span id="cb59-860"><a href="#cb59-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-861"><a href="#cb59-861" aria-hidden="true" tabindex="-1"></a>sample_tab <span class="ot">&lt;-</span> sample_tab <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"SampleID"</span>)</span>
<span id="cb59-862"><a href="#cb59-862" aria-hidden="true" tabindex="-1"></a>sample_tab<span class="sc">$</span>SampleID <span class="ot">&lt;-</span> <span class="fu">rownames</span>(sample_tab)</span>
<span id="cb59-863"><a href="#cb59-863" aria-hidden="true" tabindex="-1"></a>sample_tab <span class="ot">&lt;-</span> sample_tab <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">relocate</span>(SampleID)</span>
<span id="cb59-864"><a href="#cb59-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-865"><a href="#cb59-865" aria-hidden="true" tabindex="-1"></a>full_sample_tab <span class="ot">&lt;-</span> sample_tab</span>
<span id="cb59-866"><a href="#cb59-866" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-867"><a href="#cb59-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-870"><a href="#cb59-870" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-871"><a href="#cb59-871" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-872"><a href="#cb59-872" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-873"><a href="#cb59-873" aria-hidden="true" tabindex="-1"></a>tmp_samp_tab <span class="ot">&lt;-</span> sample_tab[<span class="fu">complete.cases</span>(sample_tab), ]</span>
<span id="cb59-874"><a href="#cb59-874" aria-hidden="true" tabindex="-1"></a>tmp_tax_tab <span class="ot">&lt;-</span> me_asv_no_low<span class="sc">$</span>tax_table</span>
<span id="cb59-875"><a href="#cb59-875" aria-hidden="true" tabindex="-1"></a>tmp_otu_tab <span class="ot">&lt;-</span> me_asv_no_low<span class="sc">$</span>otu_table</span>
<span id="cb59-876"><a href="#cb59-876" aria-hidden="true" tabindex="-1"></a>tmp_rep_fasta <span class="ot">&lt;-</span> me_asv_no_low<span class="sc">$</span>rep_fasta</span>
<span id="cb59-877"><a href="#cb59-877" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-878"><a href="#cb59-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-881"><a href="#cb59-881" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-882"><a href="#cb59-882" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb59-883"><a href="#cb59-883" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-884"><a href="#cb59-884" aria-hidden="true" tabindex="-1"></a>me_asv <span class="ot">&lt;-</span> microtable<span class="sc">$</span><span class="fu">new</span>(<span class="at">sample_table =</span> tmp_samp_tab, </span>
<span id="cb59-885"><a href="#cb59-885" aria-hidden="true" tabindex="-1"></a>                         <span class="at">otu_table =</span> tmp_otu_tab, </span>
<span id="cb59-886"><a href="#cb59-886" aria-hidden="true" tabindex="-1"></a>                         <span class="at">tax_table =</span> tmp_tax_tab, </span>
<span id="cb59-887"><a href="#cb59-887" aria-hidden="true" tabindex="-1"></a>                         <span class="at">rep_fasta =</span> tmp_rep_fasta)</span>
<span id="cb59-888"><a href="#cb59-888" aria-hidden="true" tabindex="-1"></a>me_asv<span class="sc">$</span><span class="fu">tidy_dataset</span>()</span>
<span id="cb59-889"><a href="#cb59-889" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-890"><a href="#cb59-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-891"><a href="#cb59-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-894"><a href="#cb59-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-895"><a href="#cb59-895" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-896"><a href="#cb59-896" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-897"><a href="#cb59-897" aria-hidden="true" tabindex="-1"></a>me_asv</span>
<span id="cb59-898"><a href="#cb59-898" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-899"><a href="#cb59-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-900"><a href="#cb59-900" aria-hidden="true" tabindex="-1"></a><span class="fu"># Summary</span></span>
<span id="cb59-901"><a href="#cb59-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-902"><a href="#cb59-902" aria-hidden="true" tabindex="-1"></a>Now time to summarize the data. For this we use the R package <span class="co">[</span><span class="ot">miaverse</span><span class="co">](https://microbiome.github.io)</span> <span class="co">[</span><span class="ot">@felix2024mia</span><span class="co">]</span>. </span>
<span id="cb59-903"><a href="#cb59-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-906"><a href="#cb59-906" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-907"><a href="#cb59-907" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-908"><a href="#cb59-908" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-909"><a href="#cb59-909" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(me_asv_raw<span class="sc">$</span>sample_table), <span class="fu">colnames</span>(me_asv_raw<span class="sc">$</span>otu_table))</span>
<span id="cb59-910"><a href="#cb59-910" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(me_asv<span class="sc">$</span>sample_table), <span class="fu">colnames</span>(me_asv<span class="sc">$</span>otu_table))</span>
<span id="cb59-911"><a href="#cb59-911" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-912"><a href="#cb59-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-915"><a href="#cb59-915" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-916"><a href="#cb59-916" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-917"><a href="#cb59-917" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-918"><a href="#cb59-918" aria-hidden="true" tabindex="-1"></a><span class="co"># https://github.com/microbiome/OMA/issues/202</span></span>
<span id="cb59-919"><a href="#cb59-919" aria-hidden="true" tabindex="-1"></a>tmp_counts <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(me_asv_raw<span class="sc">$</span>otu_table)</span>
<span id="cb59-920"><a href="#cb59-920" aria-hidden="true" tabindex="-1"></a>tmp_assays <span class="ot">&lt;-</span>  <span class="fu">SimpleList</span>(<span class="at">counts =</span> tmp_counts)</span>
<span id="cb59-921"><a href="#cb59-921" aria-hidden="true" tabindex="-1"></a>mia_me_asv_raw <span class="ot">&lt;-</span> <span class="fu">TreeSummarizedExperiment</span>(<span class="at">assays =</span> tmp_assays,</span>
<span id="cb59-922"><a href="#cb59-922" aria-hidden="true" tabindex="-1"></a>                                <span class="at">colData =</span> <span class="fu">DataFrame</span>(me_asv_raw<span class="sc">$</span>sample_table),</span>
<span id="cb59-923"><a href="#cb59-923" aria-hidden="true" tabindex="-1"></a>                                <span class="at">rowData =</span> <span class="fu">DataFrame</span>(me_asv_raw<span class="sc">$</span>tax_table))</span>
<span id="cb59-924"><a href="#cb59-924" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb59-925"><a href="#cb59-925" aria-hidden="true" tabindex="-1"></a>tmp_counts <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(me_asv<span class="sc">$</span>otu_table)</span>
<span id="cb59-926"><a href="#cb59-926" aria-hidden="true" tabindex="-1"></a>tmp_assays <span class="ot">&lt;-</span>  <span class="fu">SimpleList</span>(<span class="at">counts =</span> tmp_counts)</span>
<span id="cb59-927"><a href="#cb59-927" aria-hidden="true" tabindex="-1"></a>mia_me_asv <span class="ot">&lt;-</span> <span class="fu">TreeSummarizedExperiment</span>(<span class="at">assays =</span> tmp_assays,</span>
<span id="cb59-928"><a href="#cb59-928" aria-hidden="true" tabindex="-1"></a>                                <span class="at">colData =</span> <span class="fu">DataFrame</span>(me_asv<span class="sc">$</span>sample_table),</span>
<span id="cb59-929"><a href="#cb59-929" aria-hidden="true" tabindex="-1"></a>                                <span class="at">rowData =</span> <span class="fu">DataFrame</span>(me_asv<span class="sc">$</span>tax_table))</span>
<span id="cb59-930"><a href="#cb59-930" aria-hidden="true" tabindex="-1"></a>mia_me_asv_raw_summ <span class="ot">&lt;-</span> <span class="fu">summary</span>(mia_me_asv_raw, <span class="at">assay.type =</span> <span class="st">"counts"</span>)</span>
<span id="cb59-931"><a href="#cb59-931" aria-hidden="true" tabindex="-1"></a>mia_me_asv_summ <span class="ot">&lt;-</span> <span class="fu">summary</span>(mia_me_asv, <span class="at">assay.type =</span> <span class="st">"counts"</span>)</span>
<span id="cb59-932"><a href="#cb59-932" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb59-933"><a href="#cb59-933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-934"><a href="#cb59-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-937"><a href="#cb59-937" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-938"><a href="#cb59-938" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-939"><a href="#cb59-939" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-940"><a href="#cb59-940" aria-hidden="true" tabindex="-1"></a>objs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"me_asv_raw"</span>, <span class="st">"me_asv_no_na"</span>, <span class="st">"me_asv_no_cont"</span>, </span>
<span id="cb59-941"><a href="#cb59-941" aria-hidden="true" tabindex="-1"></a>          <span class="st">"me_asv_no_nc"</span>, <span class="st">"me_asv_no_low"</span>)</span>
<span id="cb59-942"><a href="#cb59-942" aria-hidden="true" tabindex="-1"></a>pipe_summary <span class="ot">&lt;-</span> <span class="fu">summarize_objs</span>(objs)</span>
<span id="cb59-943"><a href="#cb59-943" aria-hidden="true" tabindex="-1"></a><span class="co">#metric_name &lt;- c("original", "No NA kingdom", </span></span>
<span id="cb59-944"><a href="#cb59-944" aria-hidden="true" tabindex="-1"></a><span class="co">#                "no contaminants", "no neg control", </span></span>
<span id="cb59-945"><a href="#cb59-945" aria-hidden="true" tabindex="-1"></a><span class="co">#                "no low count samps")</span></span>
<span id="cb59-946"><a href="#cb59-946" aria-hidden="true" tabindex="-1"></a>pipe_summary<span class="sc">$</span>me_dataset <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb59-947"><a href="#cb59-947" aria-hidden="true" tabindex="-1"></a>  <span class="st">"original"</span>, <span class="st">"No NA kingdom"</span>, </span>
<span id="cb59-948"><a href="#cb59-948" aria-hidden="true" tabindex="-1"></a>  <span class="st">"no neg control"</span>, <span class="st">"no low count samps"</span>)</span>
<span id="cb59-949"><a href="#cb59-949" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pipe_summary)</span>
<span id="cb59-950"><a href="#cb59-950" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-951"><a href="#cb59-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-952"><a href="#cb59-952" aria-hidden="true" tabindex="-1"></a>Here we can see how the total number of ASVs, reads, and samples changed during the curation process. </span>
<span id="cb59-953"><a href="#cb59-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-956"><a href="#cb59-956" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-957"><a href="#cb59-957" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-958"><a href="#cb59-958" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-959"><a href="#cb59-959" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(pipe_summary)</span>
<span id="cb59-960"><a href="#cb59-960" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-961"><a href="#cb59-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-962"><a href="#cb59-962" aria-hidden="true" tabindex="-1"></a>And some additional metrics describing the changes. </span>
<span id="cb59-963"><a href="#cb59-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-964"><a href="#cb59-964" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Metric                <span class="pp">|</span> Start                                      <span class="pp">|</span> End                                    <span class="pp">|</span></span>
<span id="cb59-965"><a href="#cb59-965" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------------------|--------------------------------------------|----------------------------------------|</span></span>
<span id="cb59-966"><a href="#cb59-966" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Min. number reads     <span class="pp">|</span> <span class="in">`r mia_me_asv_raw_summ$samples[2]`</span>         <span class="pp">|</span> <span class="in">`r mia_me_asv_summ$samples[2]`</span>         <span class="pp">|</span></span>
<span id="cb59-967"><a href="#cb59-967" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Max. number reads     <span class="pp">|</span> <span class="in">`r mia_me_asv_raw_summ$samples[3]`</span>         <span class="pp">|</span> <span class="in">`r mia_me_asv_summ$samples[3]`</span>         <span class="pp">|</span></span>
<span id="cb59-968"><a href="#cb59-968" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Total number reads    <span class="pp">|</span> <span class="in">`r mia_me_asv_raw_summ$samples[1]`</span>         <span class="pp">|</span> <span class="in">`r mia_me_asv_summ$samples[1]`</span>         <span class="pp">|</span></span>
<span id="cb59-969"><a href="#cb59-969" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Avg number reads      <span class="pp">|</span> <span class="in">`r round(mia_me_asv_raw_summ$samples[5])`</span>  <span class="pp">|</span> <span class="in">`r round(mia_me_asv_summ$samples[5])`</span>  <span class="pp">|</span></span>
<span id="cb59-970"><a href="#cb59-970" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Median no. reads      <span class="pp">|</span> <span class="in">`r mia_me_asv_raw_summ$samples[4]`</span>         <span class="pp">|</span> <span class="in">`r mia_me_asv_summ$samples[4]`</span>         <span class="pp">|</span></span>
<span id="cb59-971"><a href="#cb59-971" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Total ASVs            <span class="pp">|</span> <span class="in">`r mia_me_asv_raw_summ$features[1]`</span>        <span class="pp">|</span> <span class="in">`r mia_me_asv_summ$features[1]`</span>        <span class="pp">|</span></span>
<span id="cb59-972"><a href="#cb59-972" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> No. singleton ASVs    <span class="pp">|</span> <span class="in">`r mia_me_asv_raw_summ$features[2]`</span>        <span class="pp">|</span> <span class="in">`r mia_me_asv_summ$features[2]`</span>        <span class="pp">|</span></span>
<span id="cb59-973"><a href="#cb59-973" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Avg ASVs per sample.  <span class="pp">|</span> <span class="in">`r round(mia_me_asv_raw_summ$features[3])`</span> <span class="pp">|</span> <span class="in">`r round(mia_me_asv_summ$features[3])`</span> <span class="pp">|</span></span>
<span id="cb59-974"><a href="#cb59-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-975"><a href="#cb59-975" aria-hidden="true" tabindex="-1"></a>We started off with <span class="in">`r nrow(me_asv_raw$tax_table)`</span> ASVs and <span class="in">`r nrow(me_asv_raw$sample_table)`</span> samples. Screening for <span class="in">`NA`</span> and non-fungal kingdom assignment removed an additional <span class="in">`r nrow(me_asv_raw$tax_table) - nrow(me_asv_no_na$tax_table)`</span> ASVs.  After removing the negative controls there were <span class="in">`r nrow(me_asv_no_nc$tax_table)`</span> ASVs and <span class="in">`r nrow(me_asv_no_nc$sample_table)`</span>. After removing low-count samples, there were <span class="in">`r nrow(me_asv$tax_table)`</span> ASVs and <span class="in">`r nrow(me_asv$sample_table)`</span> samples remaining.</span>
<span id="cb59-976"><a href="#cb59-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-979"><a href="#cb59-979" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-980"><a href="#cb59-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-981"><a href="#cb59-981" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-982"><a href="#cb59-982" aria-hidden="true" tabindex="-1"></a><span class="co">#---------Starting data-------------#</span></span>
<span id="cb59-983"><a href="#cb59-983" aria-hidden="true" tabindex="-1"></a>tmp_start <span class="ot">&lt;-</span> microeco<span class="sc">::</span><span class="fu">clone</span>(me_asv_raw)</span>
<span id="cb59-984"><a href="#cb59-984" aria-hidden="true" tabindex="-1"></a>tmp_start_rc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_start<span class="sc">$</span><span class="fu">sample_sums</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb59-985"><a href="#cb59-985" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SampleID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-986"><a href="#cb59-986" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"start_rc"</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb59-987"><a href="#cb59-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-988"><a href="#cb59-988" aria-hidden="true" tabindex="-1"></a>tmp_start_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(tmp_start<span class="sc">$</span>otu_table))</span>
<span id="cb59-989"><a href="#cb59-989" aria-hidden="true" tabindex="-1"></a>tmp_start_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowSums</span>(tmp_start_asv <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-990"><a href="#cb59-990" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SampleID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-991"><a href="#cb59-991" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"start_asv"</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb59-992"><a href="#cb59-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-993"><a href="#cb59-993" aria-hidden="true" tabindex="-1"></a><span class="co">#---------Final data-------------#</span></span>
<span id="cb59-994"><a href="#cb59-994" aria-hidden="true" tabindex="-1"></a>tmp_final <span class="ot">&lt;-</span> microeco<span class="sc">::</span><span class="fu">clone</span>(me_asv)</span>
<span id="cb59-995"><a href="#cb59-995" aria-hidden="true" tabindex="-1"></a>tmp_lotus3_rc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tmp_final<span class="sc">$</span><span class="fu">sample_sums</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb59-996"><a href="#cb59-996" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SampleID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-997"><a href="#cb59-997" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"final_rc"</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb59-998"><a href="#cb59-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-999"><a href="#cb59-999" aria-hidden="true" tabindex="-1"></a>tmp_final_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(tmp_final<span class="sc">$</span>otu_table))</span>
<span id="cb59-1000"><a href="#cb59-1000" aria-hidden="true" tabindex="-1"></a>tmp_final_asv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rowSums</span>(tmp_final_asv <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-1001"><a href="#cb59-1001" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"SampleID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-1002"><a href="#cb59-1002" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="st">"final_asv"</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb59-1003"><a href="#cb59-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1004"><a href="#cb59-1004" aria-hidden="true" tabindex="-1"></a><span class="co">#---------Summary data-------------#</span></span>
<span id="cb59-1005"><a href="#cb59-1005" aria-hidden="true" tabindex="-1"></a>tmp_summary <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">full_join</span>(tmp_start_rc, tmp_start_asv) <span class="sc">%&gt;%</span></span>
<span id="cb59-1006"><a href="#cb59-1006" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_lotus3_rc) <span class="sc">%&gt;%</span></span>
<span id="cb59-1007"><a href="#cb59-1007" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(., tmp_final_asv)</span>
<span id="cb59-1008"><a href="#cb59-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1009"><a href="#cb59-1009" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_delim</span>(tmp_summary, </span>
<span id="cb59-1010"><a href="#cb59-1010" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"files/CURATE/amf_final_summary.txt"</span>, </span>
<span id="cb59-1011"><a href="#cb59-1011" aria-hidden="true" tabindex="-1"></a>                   <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span></span>
<span id="cb59-1012"><a href="#cb59-1012" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-1013"><a href="#cb59-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1014"><a href="#cb59-1014" aria-hidden="true" tabindex="-1"></a>curate_summary <span class="ot">&lt;-</span> tmp_summary</span>
<span id="cb59-1015"><a href="#cb59-1015" aria-hidden="true" tabindex="-1"></a>removed_samples <span class="ot">&lt;-</span> curate_summary<span class="sc">$</span>SampleID[<span class="fu">is.na</span>(curate_summary<span class="sc">$</span>final_rc)]</span>
<span id="cb59-1016"><a href="#cb59-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-1017"><a href="#cb59-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1020"><a href="#cb59-1020" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-1021"><a href="#cb59-1021" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb59-1022"><a href="#cb59-1022" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-1023"><a href="#cb59-1023" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-1024"><a href="#cb59-1024" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-make-final-rc-asv-table-amf</span></span>
<span id="cb59-1025"><a href="#cb59-1025" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Beginning and ending read counts &amp; total ASVs by sample."</span></span>
<span id="cb59-1026"><a href="#cb59-1026" aria-hidden="true" tabindex="-1"></a><span class="fu">make_final_asv_rc_table</span>(curate_summary)</span>
<span id="cb59-1027"><a href="#cb59-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-1028"><a href="#cb59-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1029"><a href="#cb59-1029" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">br</span><span class="dt">&gt;</span></span>
<span id="cb59-1030"><a href="#cb59-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1031"><a href="#cb59-1031" aria-hidden="true" tabindex="-1"></a>We lost <span class="in">`r length(removed_samples)`</span> samples after curating the dataset. </span>
<span id="cb59-1032"><a href="#cb59-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1035"><a href="#cb59-1035" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-1036"><a href="#cb59-1036" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb59-1037"><a href="#cb59-1037" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-1038"><a href="#cb59-1038" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb59-1039"><a href="#cb59-1039" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(removed_samples)</span>
<span id="cb59-1040"><a href="#cb59-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-1041"><a href="#cb59-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1044"><a href="#cb59-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-1045"><a href="#cb59-1045" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-1046"><a href="#cb59-1046" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-1047"><a href="#cb59-1047" aria-hidden="true" tabindex="-1"></a><span class="co">#| comment: the following code blocks are for exporting data</span></span>
<span id="cb59-1048"><a href="#cb59-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-1049"><a href="#cb59-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1052"><a href="#cb59-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb59-1053"><a href="#cb59-1053" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-1054"><a href="#cb59-1054" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-1055"><a href="#cb59-1055" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> files/SHARE/amf_curated_data/</span>
<span id="cb59-1056"><a href="#cb59-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-1057"><a href="#cb59-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1060"><a href="#cb59-1060" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-1061"><a href="#cb59-1061" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-1062"><a href="#cb59-1062" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-1063"><a href="#cb59-1063" aria-hidden="true" tabindex="-1"></a>tmp_path <span class="ot">&lt;-</span> <span class="st">"files/SHARE/amf_curated_data/"</span></span>
<span id="cb59-1064"><a href="#cb59-1064" aria-hidden="true" tabindex="-1"></a>tmp_otu_n <span class="ot">&lt;-</span> <span class="st">"amf_otu_table.txt"</span></span>
<span id="cb59-1065"><a href="#cb59-1065" aria-hidden="true" tabindex="-1"></a>tmp_tax_n <span class="ot">&lt;-</span> <span class="st">"amf_tax_table.txt"</span></span>
<span id="cb59-1066"><a href="#cb59-1066" aria-hidden="true" tabindex="-1"></a>tmp_sam_n <span class="ot">&lt;-</span> <span class="st">"amf_sample_table.txt"</span></span>
<span id="cb59-1067"><a href="#cb59-1067" aria-hidden="true" tabindex="-1"></a>tmp_rep_n <span class="ot">&lt;-</span> <span class="st">"amf_rep_fasta.fasta"</span></span>
<span id="cb59-1068"><a href="#cb59-1068" aria-hidden="true" tabindex="-1"></a>tmp_me_n <span class="ot">&lt;-</span> <span class="st">"amf_me_asv.rds"</span></span>
<span id="cb59-1069"><a href="#cb59-1069" aria-hidden="true" tabindex="-1"></a>tmp_ps_n <span class="ot">&lt;-</span> <span class="st">"amf_ps_asv.rds"</span></span>
<span id="cb59-1070"><a href="#cb59-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-1071"><a href="#cb59-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1074"><a href="#cb59-1074" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-1075"><a href="#cb59-1075" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-1076"><a href="#cb59-1076" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-1077"><a href="#cb59-1077" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seqinr)</span>
<span id="cb59-1078"><a href="#cb59-1078" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------OTU Table--------------#</span></span>
<span id="cb59-1079"><a href="#cb59-1079" aria-hidden="true" tabindex="-1"></a>tmp_otu <span class="ot">&lt;-</span> me_asv<span class="sc">$</span>otu_table <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ASV_ID"</span>)</span>
<span id="cb59-1080"><a href="#cb59-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">write_delim</span>(tmp_otu, <span class="fu">paste</span>(tmp_path, tmp_otu_n), <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb59-1081"><a href="#cb59-1081" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------TAX Table--------------#</span></span>
<span id="cb59-1082"><a href="#cb59-1082" aria-hidden="true" tabindex="-1"></a>tmp_tax <span class="ot">&lt;-</span> me_asv<span class="sc">$</span>tax_table <span class="sc">%&gt;%</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"ASV_ID"</span>)</span>
<span id="cb59-1083"><a href="#cb59-1083" aria-hidden="true" tabindex="-1"></a><span class="fu">write_delim</span>(tmp_tax, <span class="fu">paste</span>(tmp_path, tmp_tax_n), <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb59-1084"><a href="#cb59-1084" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------SAMP Table--------------#</span></span>
<span id="cb59-1085"><a href="#cb59-1085" aria-hidden="true" tabindex="-1"></a><span class="fu">write_delim</span>(me_asv<span class="sc">$</span>sample_table, <span class="fu">paste</span>(tmp_path, tmp_sam_n), <span class="at">delim =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb59-1086"><a href="#cb59-1086" aria-hidden="true" tabindex="-1"></a><span class="co">#---------------REP FASTA--------------#</span></span>
<span id="cb59-1087"><a href="#cb59-1087" aria-hidden="true" tabindex="-1"></a><span class="fu">write.fasta</span>(</span>
<span id="cb59-1088"><a href="#cb59-1088" aria-hidden="true" tabindex="-1"></a>  <span class="at">sequences =</span> <span class="fu">as.list</span>(<span class="fu">as.character</span>(me_asv<span class="sc">$</span>rep_fasta)),</span>
<span id="cb59-1089"><a href="#cb59-1089" aria-hidden="true" tabindex="-1"></a>  <span class="at">names =</span> <span class="fu">names</span>(me_asv<span class="sc">$</span>rep_fasta),</span>
<span id="cb59-1090"><a href="#cb59-1090" aria-hidden="true" tabindex="-1"></a>  <span class="at">file.out =</span> <span class="fu">paste</span>(tmp_path, tmp_rep_n)</span>
<span id="cb59-1091"><a href="#cb59-1091" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-1092"><a href="#cb59-1092" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(me_asv, <span class="fu">paste</span>(tmp_path, tmp_me_n))</span>
<span id="cb59-1093"><a href="#cb59-1093" aria-hidden="true" tabindex="-1"></a>ps_asv <span class="ot">&lt;-</span> file2meco<span class="sc">::</span><span class="fu">meco2phyloseq</span>(me_asv)</span>
<span id="cb59-1094"><a href="#cb59-1094" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ps_asv, <span class="fu">paste</span>(tmp_path, tmp_ps_n))</span>
<span id="cb59-1095"><a href="#cb59-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-1096"><a href="#cb59-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1099"><a href="#cb59-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb59-1100"><a href="#cb59-1100" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-1101"><a href="#cb59-1101" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-1102"><a href="#cb59-1102" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> files/SHARE</span>
<span id="cb59-1103"><a href="#cb59-1103" aria-hidden="true" tabindex="-1"></a><span class="fu">zip</span> <span class="at">-r</span> amf_curated_data.zip amf_curated_data/</span>
<span id="cb59-1104"><a href="#cb59-1104" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span> <span class="at">-r</span> amf_curated_data/</span>
<span id="cb59-1105"><a href="#cb59-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-1106"><a href="#cb59-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1109"><a href="#cb59-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-1110"><a href="#cb59-1110" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb59-1111"><a href="#cb59-1111" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb59-1112"><a href="#cb59-1112" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb59-1113"><a href="#cb59-1113" aria-hidden="true" tabindex="-1"></a>gdata<span class="sc">::</span><span class="fu">keep</span>(ds_metrics, sample_tab, full_sample_tab, tax_tab, otu_tab, </span>
<span id="cb59-1114"><a href="#cb59-1114" aria-hidden="true" tabindex="-1"></a>            me_asv_raw, me_asv_no_na, me_asv_nc, sample_tab_trim, </span>
<span id="cb59-1115"><a href="#cb59-1115" aria-hidden="true" tabindex="-1"></a>            me_asv_no_nc, me_asv_no_low, me_asv, nc_asvs, nc_check, </span>
<span id="cb59-1116"><a href="#cb59-1116" aria-hidden="true" tabindex="-1"></a>            nc_remove, nc_remain, rem_nc_reads, rem_sam_reads, per_reads_rem, </span>
<span id="cb59-1117"><a href="#cb59-1117" aria-hidden="true" tabindex="-1"></a>            per_reads_ret, ret_nc_reads, ret_sam_reads, mia_me_asv_raw, ps_asv,</span>
<span id="cb59-1118"><a href="#cb59-1118" aria-hidden="true" tabindex="-1"></a>            mia_me_asv, mia_me_asv_raw_summ, mia_me_asv_summ, pipe_summary,</span>
<span id="cb59-1119"><a href="#cb59-1119" aria-hidden="true" tabindex="-1"></a>            curate_summary, removed_samples, </span>
<span id="cb59-1120"><a href="#cb59-1120" aria-hidden="true" tabindex="-1"></a>            <span class="at">sure =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-1121"><a href="#cb59-1121" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">pattern =</span> <span class="st">"tmp_"</span>))</span>
<span id="cb59-1122"><a href="#cb59-1122" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="st">"page_build/amf_curate.rdata"</span>)</span>
<span id="cb59-1123"><a href="#cb59-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(me_asv, <span class="st">"files/CURATE/amf_me_asv.rds"</span>)</span>
<span id="cb59-1124"><a href="#cb59-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ps_asv, <span class="st">"files/CURATE/amf_ps_asv.rds"</span>)</span>
<span id="cb59-1125"><a href="#cb59-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>()</span>
<span id="cb59-1126"><a href="#cb59-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-1127"><a href="#cb59-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1128"><a href="#cb59-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-1129"><a href="#cb59-1129" aria-hidden="true" tabindex="-1"></a>{{&lt; include include/code/_footer.qmd &gt;}}</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© Copyright 2025 <a href="https://metacrobe.github.io/">metacrobe</a> &amp; The SWELTR Project. Site constructed using <a href="https://quarto.org/">Quarto</a>.</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/sweltr/depth/edit/main/curate_amf.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/sweltr/depth/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>